<?xml version='1.0' encoding='GBK'?><mdroot><grdds>
<ROWSET>
<ROW num="0" ><FIXED >8,1</FIXED><CATTYP ></CATTYP><JAVACLS ></JAVACLS><MWID >SO</MWID><NAME >销售单</NAME><NOTE >销售单是正式向客户确定销售关系的凭据。
销售单确认后，业务帐上反映销售数的依据。各类业务进销存报表的销售数据以销售单的为准。</NOTE><FILE >SO.zxg</FILE><MWTYP >B</MWTYP><DTLRNG >8,1,9,8</DTLRNG><syt >x</syt><ORDER ></ORDER><SCENE ></SCENE><WIDTHMOD >0</WIDTHMOD><HEIGHTMOD >0</HEIGHTMOD><NOACCNAME >1</NOACCNAME><MANUNIT >0</MANUNIT></ROW>
</ROWSET>
</grdds><grdcelds>
<ROWSET>
<ROW num="0" ><ID >0,3,5</ID><NAME >单据日期</NAME><FLD ></FLD><VALFLD >DAT</VALFLD><DEFVAL ></DEFVAL><VALTYP >date</VALTYP><MAXLEN ></MAXLEN><CTLTYP >DATE</CTLTYP><LISTID >DATE</LISTID><LABEL ></LABEL><CHKVAL ></CHKVAL><UNCHKVAL ></UNCHKVAL><NOTNULL >1</NOTNULL><C14 >0,3,7</C14><C15 >0,3,7</C15><C16 >0,3,5</C16></ROW>
<ROW num="1" ><ID >0,4,2</ID><NAME >客户编号</NAME><FLD >CORPNAM</FLD><VALFLD >CORPID</VALFLD><DEFVAL ></DEFVAL><VALTYP >string</VALTYP><MAXLEN ></MAXLEN><CTLTYP >SELECTBOX</CTLTYP><LISTID >V_CORP</LISTID><LABEL ></LABEL><CHKVAL ></CHKVAL><UNCHKVAL ></UNCHKVAL><NOTNULL >1</NOTNULL><C14 ></C14><C15 ></C15><C16 ></C16></ROW>
<ROW num="2" ><ID >0,5,2</ID><NAME >销售单方式</NAME><FLD ></FLD><VALFLD >SUBTYP</VALFLD><DEFVAL >1</DEFVAL><VALTYP >string</VALTYP><MAXLEN ></MAXLEN><CTLTYP >COMBOBOX</CTLTYP><LISTID >V_SOTYPE</LISTID><LABEL ></LABEL><CHKVAL ></CHKVAL><UNCHKVAL ></UNCHKVAL><NOTNULL >1</NOTNULL><C14 ></C14><C15 ></C15><C16 ></C16></ROW>
<ROW num="3" ><ID >0,6,5</ID><NAME >税率</NAME><FLD ></FLD><VALFLD >REFID1</VALFLD><DEFVAL >0.17</DEFVAL><VALTYP ></VALTYP><MAXLEN ></MAXLEN><CTLTYP >COMBOBOX</CTLTYP><LISTID >V_TAXTYPE</LISTID><LABEL ></LABEL><CHKVAL ></CHKVAL><UNCHKVAL ></UNCHKVAL><NOTNULL >1</NOTNULL><C14 ></C14><C15 ></C15><C16 >0,6,5</C16></ROW>
<ROW num="4" ><ID >0,3,2</ID><NAME >单据编号</NAME><FLD ></FLD><VALFLD >BILID</VALFLD><DEFVAL ></DEFVAL><VALTYP ></VALTYP><MAXLEN ></MAXLEN><CTLTYP ></CTLTYP><LISTID ></LISTID><LABEL ></LABEL><CHKVAL ></CHKVAL><UNCHKVAL ></UNCHKVAL><NOTNULL >0</NOTNULL><C14 ></C14><C15 ></C15><C16 >0,3,2</C16></ROW>
<ROW num="5" ><ID >0,6,2</ID><NAME >摘要</NAME><FLD ></FLD><VALFLD >NOTE</VALFLD><DEFVAL ></DEFVAL><VALTYP ></VALTYP><MAXLEN ></MAXLEN><CTLTYP ></CTLTYP><LISTID ></LISTID><LABEL ></LABEL><CHKVAL ></CHKVAL><UNCHKVAL ></UNCHKVAL><NOTNULL ></NOTNULL><C14 ></C14><C15 ></C15><C16 >0,6,2</C16></ROW>
<ROW num="6" ><ID >0,4,5</ID><NAME >合同号</NAME><FLD ></FLD><VALFLD >CONTNUM</VALFLD><DEFVAL ></DEFVAL><VALTYP ></VALTYP><MAXLEN ></MAXLEN><CTLTYP ></CTLTYP><LISTID ></LISTID><LABEL ></LABEL><CHKVAL ></CHKVAL><UNCHKVAL ></UNCHKVAL><NOTNULL ></NOTNULL><C14 ></C14><C15 >0,4,7</C15><C16 >0,4,5</C16></ROW>
<ROW num="7" ><ID >0,5,5</ID><NAME >经办人id</NAME><FLD ></FLD><VALFLD >REFID2</VALFLD><DEFVAL ></DEFVAL><VALTYP ></VALTYP><MAXLEN ></MAXLEN><CTLTYP >COMBOBOX</CTLTYP><LISTID >V_USR</LISTID><LABEL ></LABEL><CHKVAL ></CHKVAL><UNCHKVAL ></UNCHKVAL><NOTNULL >1</NOTNULL><C14 ></C14><C15 >0,5,7</C15><C16 >0,5,5</C16></ROW>
<ROW num="8" ><ID >0,11,6</ID><NAME >录入人姓名</NAME><FLD ></FLD><VALFLD >CRTUSRNAM</VALFLD><DEFVAL ></DEFVAL><VALTYP ></VALTYP><MAXLEN ></MAXLEN><CTLTYP ></CTLTYP><LISTID ></LISTID><LABEL ></LABEL><CHKVAL ></CHKVAL><UNCHKVAL ></UNCHKVAL><NOTNULL ></NOTNULL><C14 ></C14><C15 ></C15><C16 >0,11,12</C16></ROW>
<ROW num="9" ><ID >0,11,2</ID><NAME >审核人姓名</NAME><FLD ></FLD><VALFLD >CHKUSRNAM</VALFLD><DEFVAL ></DEFVAL><VALTYP ></VALTYP><MAXLEN ></MAXLEN><CTLTYP ></CTLTYP><LISTID ></LISTID><LABEL ></LABEL><CHKVAL ></CHKVAL><UNCHKVAL ></UNCHKVAL><NOTNULL ></NOTNULL><C14 ></C14><C15 ></C15><C16 >0,11,2</C16></ROW>
</ROWSET>
</grdcelds><grdcolds>
<ROWSET>
<ROW num="0" ><ID >0,1</ID><NAME >商品编号</NAME><FLD ></FLD><VALFLD >ITMID</VALFLD><VALTYP >string</VALTYP><C6 ></C6><ISIDX >0</ISIDX><LABEL >NAME</LABEL><COLTYP >SELECTBOX</COLTYP><LISTID >V_ITEM_3ABil</LISTID><C11 ></C11></ROW>
<ROW num="1" ><ID >0,2</ID><NAME >商品名称</NAME><FLD ></FLD><VALFLD >ITMNAM</VALFLD><VALTYP >string</VALTYP><C6 ></C6><ISIDX ></ISIDX><LABEL ></LABEL><COLTYP ></COLTYP><LISTID ></LISTID><C11 ></C11></ROW>
<ROW num="2" ><ID >0,3</ID><NAME >数量</NAME><FLD ></FLD><VALFLD >QTY</VALFLD><VALTYP >number</VALTYP><C6 >0,5</C6><ISIDX ></ISIDX><LABEL ></LABEL><COLTYP ></COLTYP><LISTID ></LISTID><C11 ></C11></ROW>
<ROW num="3" ><ID >0,4</ID><NAME >单价</NAME><FLD ></FLD><VALFLD >PRICE</VALFLD><VALTYP >number</VALTYP><C6 >0,6</C6><ISIDX ></ISIDX><LABEL ></LABEL><COLTYP ></COLTYP><LISTID ></LISTID><C11 ></C11></ROW>
<ROW num="4" ><ID >0,5</ID><NAME >金额</NAME><FLD ></FLD><VALFLD >MNY</VALFLD><VALTYP >number</VALTYP><C6 >0,7</C6><ISIDX ></ISIDX><LABEL ></LABEL><COLTYP ></COLTYP><LISTID ></LISTID><C11 ></C11></ROW>
<ROW num="5" ><ID >0,6</ID><NAME >折扣</NAME><FLD ></FLD><VALFLD >REFNAM1</VALFLD><VALTYP ></VALTYP><C6 >0,6</C6><ISIDX ></ISIDX><LABEL ></LABEL><COLTYP ></COLTYP><LISTID ></LISTID><C11 ></C11></ROW>
<ROW num="6" ><ID >0,7</ID><NAME >小单位换算比率</NAME><FLD ></FLD><VALFLD >UNTNUM</VALFLD><VALTYP ></VALTYP><C6 >0,9</C6><ISIDX ></ISIDX><LABEL ></LABEL><COLTYP ></COLTYP><LISTID ></LISTID><C11 ></C11></ROW>
<ROW num="7" ><ID >0,8</ID><NAME >小计量单位</NAME><FLD ></FLD><VALFLD >SMLUNT</VALFLD><VALTYP ></VALTYP><C6 >0,10</C6><ISIDX ></ISIDX><LABEL ></LABEL><COLTYP ></COLTYP><LISTID ></LISTID><C11 >0,8</C11></ROW>
</ROWSET>
</grdcolds><grdbtnds>
<ROWSET>
<ROW num="0" ><ID >genSt</ID><NAME >生成提单</NAME><TIP ></TIP><BTNORD ></BTNORD><IMG >1</IMG><IMGMOUSE >1</IMGMOUSE><C7 >genSt</C7><C8 ></C8><C9 ></C9></ROW>
<ROW num="1" ><ID >toggleUnit</ID><NAME >切换大小单位</NAME><TIP ></TIP><BTNORD ></BTNORD><IMG ></IMG><IMGMOUSE ></IMGMOUSE><C7 ></C7><C8 >toggleUnit</C8><C9 >toggleUnit</C9></ROW>
<ROW num="2" ><ID >QueryINV</ID><NAME >库存和历史单价</NAME><TIP ></TIP><BTNORD ></BTNORD><IMG ></IMG><IMGMOUSE ></IMGMOUSE><C7 ></C7><C8 ></C8><C9 >QueryINV</C9></ROW>
</ROWSET>
</grdbtnds><grdjsds>
<ROWSET>
<ROW num="0" ><GRDJSDS_VALUE ></GRDJSDS_VALUE></ROW>
</ROWSET>
</grdjsds><grdosds>
<ROWSET>
<ROW num="0" ><GRDOSDS_VALUE ></GRDOSDS_VALUE></ROW>
</ROWSET>
</grdosds><grddscds>
<ROWSET>
<ROW num="0" ><ID >QueryINV</ID><NAME > 查询当前库存</NAME><DATDSC >
 SELECT ENQTY+(RVQTY+MOQTY+RVAJQTY+RVLJQTY+DJQTY+RVTFQTY)-(SHQTY+MOEXQTY+SHAJQTY+SHLJQTY+SHTFQTY) qty
 FROM 
 (
 SELECT B.ID,
        MAX(B.NAME)||&amp;apos; &amp;apos;||MAX(B.SPEC)  NAME,
        LOCID,
        DECODE(&amp;apos;3&amp;apos;,&amp;apos;3&amp;apos;,MIN(B.SMLUNT),&amp;apos;2&amp;apos;,MIN(B.UNIT),&amp;apos;吨&amp;apos;) UNIT,
        UnitQty(&amp;apos;3&amp;apos;,SUM(A.ENQTY),B.UNTNUM,B.TONNUM) ENQTY,
        UnitQty(&amp;apos;3&amp;apos;,SUM(A.RVQTY),B.UNTNUM,B.TONNUM) RVQTY,
        UnitQty(&amp;apos;3&amp;apos;,SUM(A.MOQTY),B.UNTNUM,B.TONNUM) MOQTY,
        UnitQty(&amp;apos;3&amp;apos;,SUM(A.RVAJQTY),B.UNTNUM,B.TONNUM) RVAJQTY,
        UnitQty(&amp;apos;3&amp;apos;,SUM(A.RVLJQTY),B.UNTNUM,B.TONNUM) RVLJQTY,
        UnitQty(&amp;apos;3&amp;apos;,SUM(A.DJQTY),B.UNTNUM,B.TONNUM) DJQTY,
        UnitQty(&amp;apos;3&amp;apos;,SUM(A.RVTFQTY ),B.UNTNUM,B.TONNUM) RVTFQTY,  
        UnitQty(&amp;apos;3&amp;apos;,SUM(A.SHQTY),B.UNTNUM,B.TONNUM) SHQTY,
        UnitQty(&amp;apos;3&amp;apos;,SUM(A.MOEXQTY),B.UNTNUM,B.TONNUM) MOEXQTY,
        UnitQty(&amp;apos;3&amp;apos;,SUM(A.SHAJQTY),B.UNTNUM,B.TONNUM) SHAJQTY,
        UnitQty(&amp;apos;3&amp;apos;,SUM(A.SHLJQTY),B.UNTNUM,B.TONNUM) SHLJQTY,
        UnitQty(&amp;apos;3&amp;apos;,SUM(A.SHTFQTY),B.UNTNUM,B.TONNUM) SHTFQTY
 FROM
 (
 SELECT ITEM,LOCID ,0 ENQTY,
 RVPOQTY-SHPOQTY+RVSOQTY RVQTY,RVTFQTY ,MOQTY,
 DECODE(AJQTY-ABS(AJQTY),0,AJQTY,0) RVAJQTY,
 DECODE(LJQTY-ABS(LJQTY),0,LJQTY,0) RVLJQTY,
 DJQTY,
 SHSOQTY SHQTY,SHTFQTY,MOEXQTY-MJQTY MOEXQTY,
 DECODE(AJQTY-ABS(AJQTY),0,0,abs(AJQTY)) SHAJQTY,      
 DECODE(LJQTY-ABS(LJQTY),0,0,abs(LJQTY)) SHLJQTY
 FROM SLTMOV 
 WHERE ACC like &amp;apos;[%ACCID]%&amp;apos;
 AND ORG LIKE &amp;apos;[%ORGID]%&amp;apos;  
 AND DAT&amp;lt;=TO_DATE(DECODE(&amp;apos;[%DATE2]&amp;apos;,&amp;apos;&amp;apos;,&amp;apos;2999-01-01&amp;apos;,&amp;apos;[%DATE2]&amp;apos;),&amp;apos;YYYY-MM-DD&amp;apos;) 
 AND LOCID like &amp;apos;[%LOCID]%&amp;apos;

  UNION ALL
 SELECT ITEM,LOCID,ENQTY ENQTY,0 RVQTY,0 RVTFQTY,0 MOQTY,0 RAJQTY,0 EVLJQTY,0 DJQTY,0 SHQTY,0 SHTFQTY,0 MOEXQTY,0 SHAJQTY,0 SHLJQTY
 FROM LOCSUM,V_LOC 
 WHERE v_loc.ORG LIKE &amp;apos;[%ORGID]%&amp;apos; 
 and (v_loc.ACC like &amp;apos;[%ACCID]%&amp;apos; or acc is null)
 and v_loc.GUID=locsum.loc
AND YYMM=(Greatest((select min(yymm) from SLTSUM where ORG LIKE &amp;apos;[%ORGID]%&amp;apos; ),
 nvl((select max(yymm) from SLTSUM where ORG LIKE &amp;apos;[%ORGID]%&amp;apos; 
 and yymm&amp;lt;=TO_CHAR(TO_DATE(SUBSTR(&amp;apos;[%DATE2]&amp;apos;,1,7),&amp;apos;YY-MM&amp;apos;)-1,&amp;apos;YYMM&amp;apos;)
 ),&amp;apos;0&amp;apos;)
 )
 )
 AND LOCID like &amp;apos;[%LOCID]%&amp;apos;
 ) A,ITEM B
 WHERE A.ITEM=B.GUID 
 AND UPPER(B.ID) NOT LIKE &amp;apos;Z%&amp;apos;
 AND B.ID LIKE &amp;apos;[%ITMID]%&amp;apos;
 HAVING NOT (
 SUM(ENQTY)=0 AND 
 SUM(RVQTY)=0 AND 
 SUM(MOQTY)=0 AND 
 SUM(RVAJQTY)=0 AND 
 SUM(RVLJQTY)=0 AND 
 SUM(DJQTY)=0 AND
 SUM(RVTFQTY)=0 AND
 SUM(SHQTY)=0 AND
 SUM(MOEXQTY)=0 AND
 SUM(SHAJQTY)=0 AND
 SUM(SHLJQTY)=0 and
 sum(SHTFQTY)=0   
 )
 GROUP BY B.ID,B.UNTNUM,B.TONNUM,A.LOCID
 order by A.LOCID,B.ID
 ) t </DATDSC><C4 ></C4><C5 >QueryINV</C5><C6 ></C6><C7 ></C7><C8 >QueryINV</C8><C9 >QueryINV</C9><C10 >QueryINV</C10><C11 >QueryINV</C11><C12 >QueryINV</C12><C13 >QueryINV</C13><C14 >QueryINV</C14><C15 >QueryINV</C15><C16 >QueryINV</C16><C17 >QueryINV</C17><C18 >QueryINV</C18><C19 >QueryINV</C19><C20 >QueryINV</C20><C21 >QueryINV</C21><C22 >QueryINV</C22></ROW>
<ROW num="1" ><ID >QueryPri</ID><NAME >查询历史价格</NAME><DATDSC >select  distinct nvl( round(PRICE,4),0) price 
from bildtl 
where itmid=&amp;apos;[%itmid]&amp;apos; 
and biltyp = &amp;apos;SO&amp;apos;
and acc = &amp;apos;[%SYS_ACCID]&amp;apos;
and dat&amp;gt;=(sysdate-60)
order by price</DATDSC><C4 >QueryPri</C4><C5 >QueryPri</C5><C6 >QueryPri</C6><C7 >QueryPri</C7><C8 ></C8><C9 ></C9><C10 ></C10><C11 ></C11><C12 ></C12><C13 ></C13><C14 ></C14><C15 ></C15><C16 ></C16><C17 ></C17><C18 ></C18><C19 >QueryPri</C19><C20 ></C20><C21 ></C21><C22 ></C22></ROW>
</ROWSET>
</grddscds><fldhdr>
<ROWSET>
<ROW num="0" ><BILID >1单据编号</BILID><SUBTYP >1销售单方式</SUBTYP><CORPID >1客户编号</CORPID><CORPNAM >1客户名称</CORPNAM><LOCID >1仓库|部门编号</LOCID><LOCNAM >1仓库|部门名称</LOCNAM><DAT >1单据日期</DAT><CRTUSR >1录入人</CRTUSR><CRTUSRNAM >1录入人姓名</CRTUSRNAM><CHKUSR >1审核人</CHKUSR><CHKUSRNAM >1审核人姓名</CHKUSRNAM><NOTE >1摘要</NOTE><REFID1 >1税率</REFID1><REFNAM2 >1发票号</REFNAM2><REFNAM1 >1对方订单号</REFNAM1><REFID2 >1经办人id</REFID2></ROW>
</ROWSET>
</fldhdr><flddtl>
<ROWSET>
<ROW num="0" ><ITMID >1品种编号</ITMID><ITMNAM >1品种名称</ITMNAM><ITMSPC >1规格</ITMSPC><UNIT >1计量单位</UNIT><UNTNUM >1小单位换算比率</UNTNUM><TONNUM >标准单位换算比率</TONNUM><PRICE >1单价</PRICE><QTY >1数量</QTY><TAXTYP >税率类型</TAXTYP><NOTAXMNY >不含税税额</NOTAXMNY><TAXMNY >税额</TAXMNY><MNY >1下单金额</MNY><REFID1 >0参考编号1</REFID1><REFNAM1 >1折扣</REFNAM1><REFID2 >参考编号2</REFID2><REFNAM2 >参考名称2</REFNAM2><DATFLW >DATFLW的编号</DATFLW><SMLUNT >1小计量单位</SMLUNT><REFID3 >1运费单价</REFID3><REFNAM3 >1运费金额</REFNAM3></ROW>
</ROWSET>
</flddtl><fldhdrext>
<ROWSET>
<ROW num="0" ><CONTNUM >1合同号</CONTNUM><CHNAM >1来源单据</CHNAM></ROW>
</ROWSET>
</fldhdrext></mdroot>