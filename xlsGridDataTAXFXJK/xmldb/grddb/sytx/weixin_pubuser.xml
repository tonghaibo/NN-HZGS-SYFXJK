<?xml version='1.0' encoding='GBK'?><mdroot><grdds>
<ROWSET>
<ROW num="0" ><MWTYP >F</MWTYP><MWID >weixin_pubuser</MWID><NAME >微信公众号</NAME><NOTE ></NOTE><NOACCNAME ></NOACCNAME><FILE >weixin_pubuser.zxg</FILE><SCENE ></SCENE><FIXED ></FIXED><CATTYP >WX</CATTYP><DTLRNG ></DTLRNG><BATINP ></BATINP><MANUNIT ></MANUNIT><USESMLUNT ></USESMLUNT><ITEMTABLE ></ITEMTABLE><BILHDRTABLE >weixin_pubuser</BILHDRTABLE><BILDTLTABLE ></BILDTLTABLE><COLLIST >TYP &amp;quot;类型&amp;quot;,NAME &amp;quot;名称&amp;quot;,url &amp;quot;回调URL&amp;quot;,TOKEN,APPSECRET,APPID,ENCODINGAESKEY,AGENTID &amp;quot;应用ID&amp;quot;,SERVER_CLASS &amp;quot;业务处理类&amp;quot;,MENU &amp;quot;菜单&amp;quot;</COLLIST><WHERE >1=1</WHERE><ORDER ></ORDER><DBNAME ></DBNAME><LISTSUM ></LISTSUM><LOADDATA ></LOADDATA><CHECKTITLE ></CHECKTITLE><IFBILL ></IFBILL><EXTJS ></EXTJS><JAVACLS ></JAVACLS><POST2MWID ></POST2MWID><LMS ></LMS><WIDTHMOD >1</WIDTHMOD><HEIGHTMOD ></HEIGHTMOD><CLIENTCLASS ></CLIENTCLASS><SHOWBTN ></SHOWBTN><CLOSEPAGES >1</CLOSEPAGES><syt >x</syt></ROW>
</ROWSET>
</grdds><grdcelds>
<ROWSET>
<ROW num="0" ><ID >0,6,3</ID><CELLID ></CELLID><NAME >URL</NAME><VALFLD >URL</VALFLD><DEFVAL ></DEFVAL><NOTNULL ></NOTNULL><VALTYP ></VALTYP><MAXLEN ></MAXLEN><CTLTYP ></CTLTYP><LISTID ></LISTID><WHERE ></WHERE><ORDER ></ORDER><IFQUERY ></IFQUERY><IFQUERYSCOPE ></IFQUERYSCOPE><QUERTDEFVAL ></QUERTDEFVAL><FLD ></FLD><C17 >0,3,3</C17><C18 ></C18><C19 >0,3,3</C19><C20 >0,3,3</C20></ROW>
<ROW num="1" ><ID >0,8,3</ID><CELLID ></CELLID><NAME >TOKEN</NAME><VALFLD >TOKEN</VALFLD><DEFVAL ></DEFVAL><NOTNULL ></NOTNULL><VALTYP ></VALTYP><MAXLEN ></MAXLEN><CTLTYP ></CTLTYP><LISTID ></LISTID><WHERE ></WHERE><ORDER ></ORDER><IFQUERY ></IFQUERY><IFQUERYSCOPE ></IFQUERYSCOPE><QUERTDEFVAL ></QUERTDEFVAL><FLD ></FLD><C17 >0,5,3</C17><C18 ></C18><C19 >0,5,3</C19><C20 >0,5,3</C20></ROW>
<ROW num="2" ><ID >0,10,3</ID><CELLID ></CELLID><NAME >APPID</NAME><VALFLD >APPID</VALFLD><DEFVAL ></DEFVAL><NOTNULL ></NOTNULL><VALTYP ></VALTYP><MAXLEN ></MAXLEN><CTLTYP ></CTLTYP><LISTID ></LISTID><WHERE ></WHERE><ORDER ></ORDER><IFQUERY ></IFQUERY><IFQUERYSCOPE ></IFQUERYSCOPE><QUERTDEFVAL ></QUERTDEFVAL><FLD ></FLD><C17 >0,7,3</C17><C18 ></C18><C19 >0,7,3</C19><C20 >0,7,3</C20></ROW>
<ROW num="3" ><ID >0,12,3</ID><CELLID ></CELLID><NAME >APPSECRET</NAME><VALFLD >APPSECRET</VALFLD><DEFVAL ></DEFVAL><NOTNULL ></NOTNULL><VALTYP ></VALTYP><MAXLEN ></MAXLEN><CTLTYP ></CTLTYP><LISTID ></LISTID><WHERE ></WHERE><ORDER ></ORDER><IFQUERY ></IFQUERY><IFQUERYSCOPE ></IFQUERYSCOPE><QUERTDEFVAL ></QUERTDEFVAL><FLD ></FLD><C17 >0,9,3</C17><C18 ></C18><C19 >0,9,3</C19><C20 >0,9,3</C20></ROW>
<ROW num="4" ><ID >0,18,3</ID><CELLID ></CELLID><NAME >业务JAVA类</NAME><VALFLD >SERVER_CLASS</VALFLD><DEFVAL ></DEFVAL><NOTNULL ></NOTNULL><VALTYP ></VALTYP><MAXLEN ></MAXLEN><CTLTYP ></CTLTYP><LISTID ></LISTID><WHERE ></WHERE><ORDER ></ORDER><IFQUERY ></IFQUERY><IFQUERYSCOPE ></IFQUERYSCOPE><QUERTDEFVAL ></QUERTDEFVAL><FLD ></FLD><C17 ></C17><C18 ></C18><C19 ></C19><C20 >0,15,3</C20></ROW>
<ROW num="5" ><ID >0,14,3</ID><CELLID ></CELLID><NAME >EncodingAESKey</NAME><VALFLD >ENCODINGAESKEY</VALFLD><DEFVAL ></DEFVAL><NOTNULL ></NOTNULL><VALTYP ></VALTYP><MAXLEN ></MAXLEN><CTLTYP ></CTLTYP><LISTID ></LISTID><WHERE ></WHERE><ORDER ></ORDER><IFQUERY ></IFQUERY><IFQUERYSCOPE ></IFQUERYSCOPE><QUERTDEFVAL ></QUERTDEFVAL><FLD ></FLD><C17 ></C17><C18 ></C18><C19 ></C19><C20 >0,11,3</C20></ROW>
<ROW num="6" ><ID >0,16,3</ID><CELLID ></CELLID><NAME >应用ID</NAME><VALFLD >AGENTID</VALFLD><DEFVAL ></DEFVAL><NOTNULL ></NOTNULL><VALTYP ></VALTYP><MAXLEN ></MAXLEN><CTLTYP ></CTLTYP><LISTID ></LISTID><WHERE ></WHERE><ORDER ></ORDER><IFQUERY ></IFQUERY><IFQUERYSCOPE ></IFQUERYSCOPE><QUERTDEFVAL ></QUERTDEFVAL><FLD ></FLD><C17 ></C17><C18 ></C18><C19 ></C19><C20 >0,13,3</C20></ROW>
<ROW num="7" ><ID >0,4,3</ID><CELLID ></CELLID><NAME >名称</NAME><VALFLD >NAME</VALFLD><DEFVAL ></DEFVAL><NOTNULL ></NOTNULL><VALTYP ></VALTYP><MAXLEN ></MAXLEN><CTLTYP ></CTLTYP><LISTID ></LISTID><WHERE ></WHERE><ORDER ></ORDER><IFQUERY ></IFQUERY><IFQUERYSCOPE ></IFQUERYSCOPE><QUERTDEFVAL ></QUERTDEFVAL><FLD ></FLD><C17 ></C17><C18 ></C18><C19 ></C19><C20 >0,4,3</C20></ROW>
<ROW num="8" ><ID >0,4,6</ID><CELLID ></CELLID><NAME >类型</NAME><VALFLD >TYP</VALFLD><DEFVAL ></DEFVAL><NOTNULL ></NOTNULL><VALTYP ></VALTYP><MAXLEN ></MAXLEN><CTLTYP ></CTLTYP><LISTID ></LISTID><WHERE ></WHERE><ORDER ></ORDER><IFQUERY ></IFQUERY><IFQUERYSCOPE ></IFQUERYSCOPE><QUERTDEFVAL ></QUERTDEFVAL><FLD ></FLD><C17 ></C17><C18 ></C18><C19 ></C19><C20 ></C20></ROW>
</ROWSET>
</grdcelds><grdjsds>
<ROWSET>
<ROW num="0" ><GRDJSDS_VALUE >
//数据加载完毕
function _thisOnpost_loaddata(sheet)
{
 	_this.LoadScene(sheet,10);
 	_this.SetAutoFixRowHeightMode(sheet,1);
 	var param=&amp;quot;{ \&amp;quot;button\&amp;quot;:[ {\&amp;quot;type\&amp;quot;:\&amp;quot;click\&amp;quot;,\&amp;quot;name\&amp;quot;:\&amp;quot;今日歌曲\&amp;quot;,\&amp;quot;key\&amp;quot;:\&amp;quot;V1001_TODAY_MUSIC\&amp;quot; }, { \&amp;quot;type\&amp;quot;:\&amp;quot;click\&amp;quot;, \&amp;quot;name\&amp;quot;:\&amp;quot;歌手简介\&amp;quot;, \&amp;quot;key\&amp;quot;:\&amp;quot;V1001_TODAY_SINGER\&amp;quot;    },{  \&amp;quot;name\&amp;quot;:\&amp;quot;菜单\&amp;quot;, \&amp;quot;sub_button\&amp;quot;:[  { \&amp;quot;type\&amp;quot;:\&amp;quot;click\&amp;quot;,  \&amp;quot;name\&amp;quot;:\&amp;quot;hello word\&amp;quot;, \&amp;quot;key\&amp;quot;:\&amp;quot;V1001_HELLO_WORLD\&amp;quot; },{  \&amp;quot;type\&amp;quot;:\&amp;quot;click\&amp;quot;,    \&amp;quot;name\&amp;quot;:\&amp;quot;赞一下我们\&amp;quot;,  \&amp;quot;key\&amp;quot;:\&amp;quot;V1001_GOOD\&amp;quot; }]  }]}&amp;quot;;
       // _this.SetCellText(0,13,3,param);
       
       _this.ShowTabBar(1);
       _this.SetSheetName(0,&amp;quot;开发接口&amp;quot;);
       _this.SetSheetName(1,&amp;quot;菜单配置&amp;quot;);
       _this.SetToCodeEditor(&amp;quot;&amp;quot;,1,5,1,&amp;quot;&amp;quot;,&amp;quot;&amp;quot;,&amp;quot;&amp;quot;);
}

//点击按钮
function _thisOnButtonCtrlClick(id,sheet,row,col)
{
	if(sheet == 1 &amp;&amp; row==3&amp;&amp;col==4)
	{	
		var jos=_this.GetCellText(sheet,5,1);
		if (jos == &amp;quot;&amp;quot;) {
			alert(&amp;quot;菜单内容不能为空！&amp;quot;);
			return;
		}
		
		var token=getaccesstoken();
		var url=&amp;quot;https://api.weixin.qq.com/cgi-bin/menu/create&amp;quot;;
		var obj=new Object();
		obj.url=url;
		obj.token=token;
		obj.jos=jos;
		var ret = invokeOSFuncExt(&amp;quot;Postxeixinhttp&amp;quot;,obj);
		var jsonobj=eval(&amp;apos;(&amp;apos;+ret+&amp;apos;)&amp;apos;);
		if(jsonobj.errcode==0){
			alert(&amp;quot;创建/更新成功！&amp;quot;);
		}
		else{
			alert(&amp;quot;创建/更新失败！errcode:&amp;quot;+jsonobj.errcode+&amp;quot;   errmsg:&amp;quot;+jsonobj.errmsg);
		}
		
	}
	else if(sheet == 1 &amp;&amp; row==3&amp;&amp;col==2)
	{	
		var token=getaccesstoken();
//		var param=&amp;quot;access_token=&amp;quot;+token;
		var url=&amp;quot;https://api.weixin.qq.com/cgi-bin/menu/get?access_token=&amp;quot;+token;
//		var url=&amp;quot;https://api.weixin.qq.com/cgi-bin/menu/get&amp;quot;;	
		var obj=new Object();
		obj.url=url;
//		obj.param=param;
		var ret = invokeOSFuncExt(&amp;quot;Getxeixinhttp&amp;quot;,obj);
		ret=ret.substring(8,ret.length-1);
		
		_this.SetCellText(sheet,5,1,ret);
		
	}
	
	else if(sheet == 1 &amp;&amp; row==3&amp;&amp;col==6)
	{	
		if (!confirm(&amp;quot;是否确定要删除菜单吗？&amp;quot;)) return;
		
		var token=getaccesstoken();
//		var param=&amp;quot;access_token=&amp;quot;+token;
		var url=&amp;quot;https://api.weixin.qq.com/cgi-bin/menu/delete?access_token=&amp;quot;+token;	
		var obj=new Object();
		obj.url=url;
//		obj.param=param;
		var ret = invokeOSFuncExt(&amp;quot;Getxeixinhttp&amp;quot;,obj);
		var jsonobj=eval(&amp;apos;(&amp;apos;+ret+&amp;apos;)&amp;apos;);
		if(jsonobj.errcode==0){
			alert(&amp;quot;删除成功！&amp;quot;)
		}
		else{
			alert(&amp;quot;删除失败！errcode:&amp;quot;+jsonobj.errcode+&amp;quot;   errmsg:&amp;quot;+jsonobj.errmsg);
		}
		
	}
	else if(sheet == 1 &amp;&amp; row==3&amp;&amp;col==8) {
		var url = _this.GetCellText(0,6,3);
		var mwid = url.substring(url.indexOf(&amp;quot;osp=&amp;quot;)+4);
		mwid = mwid.split(&amp;quot;.&amp;quot;)[1];
		window.open(&amp;quot;show.sp?grdid=&amp;quot;+mwid+&amp;quot;&amp;token=&amp;quot;+_this.GetCellText(0,8,3)+&amp;quot;&amp;appid=&amp;quot;+_this.GetCellText(0,10,3)+&amp;quot;&amp;appsecret=&amp;quot;+_this.GetCellText(0,12,3));
	}
}

function getaccesstoken()
{
	var appid=_this.GetCellText(0,10,3);
	var secret=_this.GetCellText(0,12,3);
	var url=&amp;quot;https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&amp;appid=&amp;quot;+appid+&amp;quot;&amp;secret=&amp;quot;+secret;
	var obj=new Object();
	obj.url=url;
	var ret=invokeOSFuncExt(&amp;quot;gettoken&amp;quot;,obj);
	var jsonobj=eval(&amp;quot;(&amp;quot;+ret+&amp;quot;)&amp;quot;);
	return jsonobj.access_token;
}
</GRDJSDS_VALUE></ROW>
</ROWSET>
</grdjsds><grdosds>
<ROWSET>
<ROW num="0" ><GRDOSDS_VALUE >var webget = new JavaPackage(&amp;quot;com.xlsgrid.net.webget&amp;quot;);
var weixin= new JavaPackage(&amp;quot;com.xlsgrid.net.weixin&amp;quot;);
function Getxeixinhttp()
{
	var httpcall = new webget.HttpCall();
	var ret = httpcall.Get(url,&amp;quot;UTF-8&amp;quot;);	
	return ret;
}
function Postxeixinhttp()
{
	var urls=url+&amp;quot;?access_token=&amp;quot;+token;
        var result =weixin.WeixinUtil.httpRequest(urls,&amp;quot;POST&amp;quot;,jos);  
        return result;
}
function gettoken()
{
	var httpcall = new webget.HttpCall();
	var ret = httpcall.Get(url,&amp;quot;UTF-8&amp;quot;);	
	return ret;
}
</GRDOSDS_VALUE></ROW>
</ROWSET>
</grdosds><fldhdr>
<ROWSET>
<ROW num="0" ><BILID >1单据编号</BILID><STAT >0单据状态</STAT><SUBTYP >0子类型</SUBTYP><CORPID >0往来单位编号</CORPID><CORPNAM >0往来单位名称</CORPNAM><LOCID >0仓库|部门编号</LOCID><LOCNAM >0仓库|部门名称</LOCNAM><DAT >0单据日期</DAT><CRTUSR >1录入人</CRTUSR><CRTUSRNAM >0录入人姓名</CRTUSRNAM><CRTDAT >0录入日期</CRTDAT><CHKUSR >1审核人</CHKUSR><CHKUSRNAM >0审核人姓名</CHKUSRNAM><CHKDAT >0审核日期</CHKDAT><SUMQTY >0合计金额</SUMQTY><SUMMNY >0合计金额</SUMMNY><REFID1 >0扩展字段</REFID1><REFNAM1 >0扩展字段</REFNAM1><REFID2 >0扩展字段</REFID2><REFNAM2 >0扩展字段</REFNAM2><REFID3 >0扩展字段</REFID3><REFNAM3 >0扩展字段</REFNAM3><REFID4 >0扩展字段</REFID4><REFNAM4 >0扩展字段</REFNAM4><REFID5 >0扩展字段</REFID5><REFNAM5 >0扩展字段</REFNAM5><REFID6 >0扩展字段</REFID6><REFNAM6 >0扩展字段</REFNAM6><NOTE >0备注</NOTE></ROW>
</ROWSET>
</fldhdr><flddtl>
<ROWSET>
<ROW num="0" ><SEQID >1明细序号</SEQID><ITMID >1品种编号</ITMID><ITMNAM >0品种名称</ITMNAM><ITEMPC >0品种批次号</ITEMPC><ITMSPC >0规格</ITMSPC><UNIT >0计量单位</UNIT><SMLUNT >0小计量单位</SMLUNT><UNTNUM >0大单位转小单位因子</UNTNUM><PRICE >0价格</PRICE><QTY >0数量</QTY><TAXTYP >0税率类型</TAXTYP><NOTAXMNY >0不含税税额</NOTAXMNY><TAXMNY >0税额</TAXMNY><MNY >0下单金额</MNY><REFID1 >0扩展字段</REFID1><REFNAM1 >0扩展字段</REFNAM1><REFID2 >0扩展字段</REFID2><REFNAM2 >0扩展字段</REFNAM2><REFID3 >0扩展字段</REFID3><REFNAM3 >0扩展字段</REFNAM3><REFID4 >0扩展字段</REFID4><REFNAM4 >0扩展字段</REFNAM4><REFID5 >0扩展字段</REFID5><REFNAM5 >0扩展字段</REFNAM5></ROW>
</ROWSET>
</flddtl></mdroot>