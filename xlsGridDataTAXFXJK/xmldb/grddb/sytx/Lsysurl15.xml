<?xml version='1.0' encoding='GBK'?><mdroot><grdds>
<ROWSET>
<ROW num="0" ><MWTYP >Q</MWTYP><MWID >Lsysurl15</MWID><NAME >测试</NAME><NOTE ></NOTE><NOACCNAME ></NOACCNAME><FILE >Lsysurl15.zxg</FILE><SCENE ></SCENE><FIXED >1,0</FIXED><CATTYP ></CATTYP><DTLRNG ></DTLRNG><BATINP ></BATINP><MANUNIT ></MANUNIT><USESMLUNT ></USESMLUNT><ITEMTABLE ></ITEMTABLE><BILHDRTABLE ></BILHDRTABLE><BILDTLTABLE ></BILDTLTABLE><COLLIST ></COLLIST><WHERE ></WHERE><ORDER ></ORDER><DBNAME ></DBNAME><LISTSUM ></LISTSUM><LOADDATA ></LOADDATA><CHECKTITLE ></CHECKTITLE><IFBILL ></IFBILL><EXTJS ></EXTJS><JAVACLS ></JAVACLS><POST2MWID ></POST2MWID><LMS ></LMS><WIDTHMOD ></WIDTHMOD><HEIGHTMOD ></HEIGHTMOD><CLIENTCLASS ></CLIENTCLASS><SHOWBTN ></SHOWBTN><CLOSEPAGES ></CLOSEPAGES><syt >x</syt></ROW>
</ROWSET>
</grdds><grdbtnds>
<ROWSET>
<ROW num="0" ><ID >inst</ID><NAME >插入</NAME><ACTTYP ></ACTTYP><URL ></URL><URLTARGET ></URLTARGET><TIP ></TIP><BTNORD >7</BTNORD><IMG >4</IMG><IMGMOUSE >4</IMGMOUSE><C10 ></C10><C11 >insert</C11><C12 >insert</C12><C13 >inst</C13><C14 ></C14></ROW>
<ROW num="1" ><ID >delt</ID><NAME >删除</NAME><ACTTYP ></ACTTYP><URL ></URL><URLTARGET ></URLTARGET><TIP ></TIP><BTNORD >8</BTNORD><IMG >2</IMG><IMGMOUSE >2</IMGMOUSE><C10 ></C10><C11 >delt</C11><C12 >delt</C12><C13 >delt</C13><C14 ></C14></ROW>
<ROW num="2" ><ID >save</ID><NAME >保存</NAME><ACTTYP ></ACTTYP><URL ></URL><URLTARGET ></URLTARGET><TIP ></TIP><BTNORD >9</BTNORD><IMG >5</IMG><IMGMOUSE >5</IMGMOUSE><C10 ></C10><C11 >save</C11><C12 >save</C12><C13 >save</C13><C14 ></C14></ROW>
</ROWSET>
</grdbtnds><grdpamds>
<ROWSET>
<ROW num="0" ><ID >myorgid</ID><NAME >组织</NAME><NOTNULL ></NOTNULL><KEYVAL >V_ORG</KEYVAL><INPCTL >idlist</INPCTL><DISPORD >1</DISPORD><SQLWHE ></SQLWHE><DEFVAL >[%SYS_ORGID]</DEFVAL><TIP ></TIP><EDTFLG >0</EDTFLG><VISFLG >0</VISFLG><KEYFLG ></KEYFLG><C13 ></C13><C14 >myorgid</C14><C15 >myorgid</C15><C16 >myorgid</C16><C17 >myorgid</C17><C18 >myorgid</C18><C19 >myorgid</C19><C20 >myorgid</C20><C21 >myorgid</C21><C22 >myorgid</C22><C23 ></C23><C24 >myorgid</C24></ROW>
<ROW num="1" ><ID >menu</ID><NAME >分类</NAME><NOTNULL ></NOTNULL><KEYVAL >V_LSYSURLCLASS</KEYVAL><INPCTL >idlist</INPCTL><DISPORD >2</DISPORD><SQLWHE >orgid=&amp;apos;[%SYS_DEFORG]&amp;apos;</SQLWHE><DEFVAL ></DEFVAL><TIP ></TIP><EDTFLG >1</EDTFLG><VISFLG >1</VISFLG><KEYFLG ></KEYFLG><C13 >menu</C13><C14 ></C14><C15 ></C15><C16 >menu</C16><C17 ></C17><C18 ></C18><C19 >menu</C19><C20 >menu</C20><C21 >menu</C21><C22 >menu</C22><C23 >menu</C23><C24 >menu</C24></ROW>
<ROW num="2" ><ID >info</ID><NAME >关键字</NAME><NOTNULL ></NOTNULL><KEYVAL ></KEYVAL><INPCTL ></INPCTL><DISPORD >4</DISPORD><SQLWHE ></SQLWHE><DEFVAL ></DEFVAL><TIP ></TIP><EDTFLG >1</EDTFLG><VISFLG >1</VISFLG><KEYFLG ></KEYFLG><C13 ></C13><C14 ></C14><C15 ></C15><C16 ></C16><C17 ></C17><C18 ></C18><C19 ></C19><C20 >info</C20><C21 >info</C21><C22 ></C22><C23 ></C23><C24 >info</C24></ROW>
</ROWSET>
</grdpamds><grdshwds>
<ROWSET>
<ROW num="0" ><ID >0,1,1</ID><NAME ></NAME><DBNAME ></DBNAME><DSKEY >DSC:Detail</DSKEY><NROW >3</NROW><NCOL >16</NCOL><PAGES ></PAGES><PAGESIZE ></PAGESIZE><URL ></URL><CTLTYP ></CTLTYP><DYNCTL ></DYNCTL><LISTID ></LISTID><ISCROSS ></ISCROSS><HROW ></HROW><HCOLS ></HCOLS><ROWORDER ></ROWORDER><VCOLS ></VCOLS><VCOLSQL ></VCOLSQL><VALUECOL ></VALUECOL></ROW>
</ROWSET>
</grdshwds><grdjsds>
<ROWSET>
<ROW num="0" ><GRDJSDS_VALUE >var sheet = 0;
var G_IMAGEMENUXML = &amp;quot;&amp;lt;item id=\&amp;quot;m_img_select\&amp;quot; name=\&amp;quot;选择图片\&amp;quot;/&amp;gt;&amp;lt;item id=\&amp;quot;m_img_modify\&amp;quot; name=\&amp;quot;编辑图片\&amp;quot;/&amp;gt;&amp;lt;item id=\&amp;quot;m_img_preview\&amp;quot; name=\&amp;quot;预览图片\&amp;quot;/&amp;gt;&amp;lt;item id=\&amp;quot;m_img_upload\&amp;quot; name=\&amp;quot;选择本地图片上传\&amp;quot;/&amp;gt;&amp;quot;;
var G_EDITMENUXML = &amp;quot;&amp;lt;item id=\&amp;quot;m_edit_html\&amp;quot; name=\&amp;quot;HTML编辑\&amp;quot;/&amp;gt;&amp;lt;item id=\&amp;quot;m_edit_text\&amp;quot; name=\&amp;quot;文本编辑\&amp;quot;/&amp;gt;&amp;quot;;


//数据加载完毕
function _thisOnpost_loaddata(sheet)
{

	_this.SetAttribe(&amp;quot;SHEET_0&amp;quot;,_this.ATTR_SHEET_SELECTFLAG,_this.SELECTFLAG_SINGLEROW);
	_this.SetColVisible(sheet,1,-1);
	_this.SetColVisible(sheet,2,-1);
	_this.SetColVisible(sheet,_this.GetColCount(sheet),-1);
	
	for (var row = 1; row &amp;lt; _this.GetRowCount(sheet); row ++) {
		_this.SetToBoolBox(sheet,row,0);
		_this.SetToButton(&amp;quot;&amp;quot;,sheet,row,9,&amp;quot;&amp;quot;,&amp;quot;&amp;quot;,G_IMAGEMENUXML,0,16,16);
		_this.SetToButton(&amp;quot;&amp;quot;,sheet,row,11,&amp;quot;&amp;quot;,&amp;quot;&amp;quot;,G_IMAGEMENUXML,0,16,16);
		_this.SetToButton(&amp;quot;&amp;quot;,sheet,row,7,&amp;quot;&amp;quot;,&amp;quot;&amp;quot;,G_EDITMENUXML ,0,16,16);
		if(_this.GetCellText(sheet,row,2)==&amp;quot;&amp;quot; ) 
			_this.SetCellText(sheet,row,2,G_DEFORG);

	}
	
	_this.SetColName(sheet,0,&amp;quot;FLG&amp;quot;);
	_this.SetColName(sheet,1,&amp;quot;GUID&amp;quot;);
	_this.SetColName(sheet,2,&amp;quot;ORG&amp;quot;);
	_this.SetColName(sheet,3,&amp;quot;REFID&amp;quot;);
	_this.SetColName(sheet,4,&amp;quot;ID&amp;quot;);
	_this.SetColName(sheet,5,&amp;quot;NAME&amp;quot;);
	_this.SetColName(sheet,6,&amp;quot;NOTE&amp;quot;);
	_this.SetColName(sheet,8,&amp;quot;ICON&amp;quot;);
	_this.SetColName(sheet,10,&amp;quot;ICON2&amp;quot;);
	_this.SetColName(sheet,12,&amp;quot;SEQID&amp;quot;);
	_this.SetColName(sheet,13,&amp;quot;URL&amp;quot;);
	_this.SetColName(sheet,14,&amp;quot;TARGET&amp;quot;);
	_this.SetColName(sheet,15,&amp;quot;HTMLGUID&amp;quot;);
	_this.SetColName(sheet,16,&amp;quot;CONTEXTES&amp;quot;);


	_this.AutoFixScreenWidth();
}


//插入
function inst()
{
	var row1 = _this.GetCurrentRow(0);
	if (row1 == -1) row1 = 1;
	var row2 = _this.AppendRow(sheet,row1);
	_sql.querytods(&amp;quot;SEQ&amp;quot;, &amp;quot;&amp;quot;);
	_this.SetCellText(sheet,row2,4,_this.XMLDS_GetStringAt(0,0));
	_this.SetCellText(sheet,row2,2,G_DEFORG);
	_this.SetCellText(sheet,row2,3,_this.GetCellText(sheet,row1,3));
	_this.SetToButton(&amp;quot;&amp;quot;,sheet,row2,9,&amp;quot;&amp;quot;,&amp;quot;&amp;quot;,G_IMAGEMENUXML,0,16,16);
	_this.SetToButton(&amp;quot;&amp;quot;,sheet,row2,11,&amp;quot;&amp;quot;,&amp;quot;&amp;quot;,G_IMAGEMENUXML,0,16,16);
	_this.SetToButton(&amp;quot;&amp;quot;,sheet,row2,7,&amp;quot;&amp;quot;,&amp;quot;&amp;quot;,G_EDITMENUXML ,0,16,16);

}

//删除
function delt()
{
	//POST方式调用网络OS函数
	var param = new Object();
	param.xmlstr = _this.GetXml(sheet,1,0,_this.GetRowCount(sheet)-1,_this.GetColCount(sheet)-1).replace(/&amp;/g,&amp;quot;#$&amp;quot;);
	
	try {
		if (!window.confirm(&amp;quot;是否确定删除操作? 此操作不可恢复!!!&amp;quot;)) return;
		var msg = invokeOSFuncExt(&amp;quot;delt&amp;quot;,param);
		alert ( msg );
		try { window.opener.lchref(); } catch ( ee ) { }
		for ( var i=1;i&amp;lt;_this.GetRowCount(0);i++){
			if(_this.GetCellText(0,i,0)==&amp;quot;1&amp;quot;)_this.DeleteRow(0,i);
			
		}
		//window.location.href = window.location.href;
	}
	catch ( e ) {
		alert ( e );
	}
}

//保存
function save()
{
	_save(true);
}

//保存
function _save(prompt)
{
	var param = new Object();
	param.xmlstr = _this.GetXml(sheet,1,1,_this.GetRowCount(sheet)-1,_this.GetColCount(sheet)-1).replace(/&amp;/g,&amp;quot;#$&amp;quot;);
	
	try {
		var msg = invokeOSFuncExt(&amp;quot;save&amp;quot;,param);
		if ( prompt ) {
			alert ( msg );
			try { window.opener.lchref(); } catch ( ee ) { }
		}
		
	}
	catch ( e ) {
		alert ( e );
	}
}


//修改单元格内容
function _thisOnCellModify(sheet,row,col,oldvalue,newvalue)
{
	if ( _this.GetCellText(sheet,row,4) == &amp;quot;&amp;quot;) {
		_sql.querytods(&amp;quot;SEQ&amp;quot;, &amp;quot;&amp;quot;);
		_this.SetCellText(sheet,row,4,_this.XMLDS_GetStringAt(0,0));
		
	}
	if ( _this.GetCellText(sheet,row,2) == &amp;quot;&amp;quot;) {
		_this.SetCellText(sheet,row,2,document.getElementById(&amp;quot;myorgid&amp;quot;).value);
	}
}

function _thisOnMenuItemSelect(sheet,row,col,menuitemid)
{
	var id=menuitemid;
	//&amp;quot;&amp;lt;item id=\&amp;quot;m_img_select\&amp;quot; name=\&amp;quot;选择图片\&amp;quot;/&amp;gt;&amp;lt;item id=\&amp;quot;m_img_modify\&amp;quot; name=\&amp;quot;编辑图片\&amp;quot;/&amp;gt;&amp;lt;item id=\&amp;quot;m_img_preview\&amp;quot; name=\&amp;quot;预览图片\&amp;quot;/&amp;gt;&amp;quot;;

	if(id==&amp;quot;m_img_modify&amp;quot;){
		var imgurl = _this.GetCellText(sheet,row,col-1);
		var imgguid = &amp;quot;&amp;quot;;
		var prestr = &amp;quot;EAFormBlob.sp?guid=&amp;quot;;
		if(imgurl.substring(0,prestr.length)==prestr){
			imgguid = imgurl.substring(prestr.length );
		}
		try{
			var bw = &amp;quot;120&amp;quot;;// _this.GetCellText(sheet,3,8);
			var bh = &amp;quot;120&amp;quot;;//_this.GetCellText(sheet,3,9);
//			if(bh==&amp;quot;&amp;quot;||row!==7)bh= &amp;quot;120&amp;quot;;
//			if(bw==&amp;quot;&amp;quot;||row!==7)bw= &amp;quot;120&amp;quot;;
//
			var url = &amp;quot;show.sp?grdid=ImageEdit&amp;formguid=&amp;quot;+imgguid +&amp;quot;&amp;bigimgw=&amp;quot;+bw+&amp;quot;&amp;bigimgh=&amp;quot;+bh+&amp;quot;&amp;imgw=&amp;imgh=&amp;smlimgw=&amp;smlimgh=&amp;quot;;
			
			var ret = window.showModalDialog(url,&amp;quot;&amp;quot;,&amp;quot;dialogwidth:1024pt;dialogheight:600pt;help:yes;resizable:yes;&amp;quot;);
			if(ret!=undefined){
				
				var ss = ret.split(&amp;quot;,&amp;quot;);
				_this.SetCellText(sheet,row,col-1,prestr+ss[0]);
//				if(ss.length&amp;gt;=5&amp;&amp;row==7){
//					_this.SetCellText(sheet,3,8,ss[3]);
//					_this.SetCellText(sheet,3,9,ss[4]);
//				}
			}
		}catch(e){}
	}
	else if(id==&amp;quot;m_img_select&amp;quot;){
		var retval=window.showModalDialog(&amp;quot;iconbatch.sp?rettyp=WEBPATH&amp;quot;,&amp;quot;&amp;quot;,&amp;quot;dialogHeight=500pt; dialogWidth=800pt;status=no&amp;quot;); 
		if (retval!=&amp;quot;&amp;quot; &amp;&amp; retval!=undefined ){
			_this.SetCellText(sheet,row,col-1, retval );
		}
	}
	else if(id==&amp;quot;m_img_preview&amp;quot;){
		previewimg(_this.GetCellText(sheet,row,col-1));
	}
	else if(id==&amp;quot;m_img_upload&amp;quot;){//选择本地图片上传
		var filename = _this.SelectFile(&amp;quot;&amp;quot;);
		if (filename !=&amp;quot;&amp;quot; ) {
			_this.OpenHttpRequest(homeurl+&amp;quot;EAFormBlobUpload.sp&amp;quot;,&amp;quot;UPLOAD&amp;quot;);
			_this.AddHttpRequestParam(&amp;quot;action&amp;quot;,&amp;quot;upload&amp;quot;,0);
			_this.AddHttpRequestParam(&amp;quot;data&amp;quot;,filename ,1);
			_this.AddHttpRequestParam(&amp;quot;formguid&amp;quot;,&amp;quot;&amp;quot;,0);
			_this.AddHttpRequestParam(&amp;quot;sytid&amp;quot;,G_SYTID,0);
			_this.AddHttpRequestParam(&amp;quot;grdid&amp;quot;,G_GRDID,0);
			_this.AddHttpRequestParam(&amp;quot;fileurl&amp;quot;,filename ,0);
			var ret = _this.SendHttpRequest();
			_this.CloseHttpRequest();
			if(ret!=&amp;quot;&amp;quot; ) {
				_this.SetCellText(sheet,row,col-1, &amp;quot;EAFormBlob.sp?guid=&amp;quot;+ret);
			}
		}
	}
	//var G_EDITMENUXML = &amp;quot;&amp;lt;item id=\&amp;quot;m_edit_html\&amp;quot; name=\&amp;quot;HTML编辑\&amp;quot;/&amp;gt;&amp;lt;item id=\&amp;quot;m_edit_text\&amp;quot; name=\&amp;quot;文本编辑\&amp;quot;/&amp;gt;&amp;quot;;
	else if(id==&amp;quot;m_edit_text&amp;quot;){//
		var guid=_this.GetCellText(sheet,row,_this.GetColCount(0)-1);
		var ret = window.showModalDialog(&amp;quot;show.sp?grdid=HtmlEdit&amp;guid=&amp;quot;+guid,null,&amp;quot;dialogwidth:1024pt;dialogheight:600pt;help:yes;resizable:yes;&amp;quot;);
		if(ret!=undefined)
		{
			_this.SetCellText(sheet,row,_this.GetColCount(0)-1,ret);
			_this.SetCellShowText(sheet,row,5,_this.HttpCall(&amp;quot;EAFormBlob.sp?guid=&amp;quot;+ret));
		}
	}
	else if(id==&amp;quot;m_edit_html&amp;quot;){//
		var guid=_this.GetCellText(sheet,row,_this.GetColCount(0)-1);
		var ret = window.showModalDialog(&amp;quot;show.sp?grdid=HtmlEdit&amp;guid=&amp;quot;+guid,null,&amp;quot;dialogwidth:1024pt;dialogheight:600pt;help:yes;resizable:yes;&amp;quot;);
		if(ret!=undefined)
		{
			_this.SetCellText(sheet,row,_this.GetColCount(0)-1,ret);
		}
	}

}
function previewimg(url){
	window.open(url);
	//var w = window.open(&amp;quot;&amp;quot;,&amp;quot;&amp;quot;,&amp;quot;width:800;height:600&amp;quot;);
	//w.document.body.innerHTML=&amp;quot;&amp;lt;img src=&amp;apos;http://www.xlsgrid.net/xlsgrid/ROOT_XLSGRID/&amp;quot;+url+&amp;quot;&amp;apos;&amp;gt;&amp;quot;;
}
</GRDJSDS_VALUE></ROW>
</ROWSET>
</grdjsds><grdosds>
<ROWSET>
<ROW num="0" ><GRDOSDS_VALUE >var pubpack= new JavaPackage(&amp;quot;com.xlsgrid.net.pub&amp;quot;);
var pub = new JavaPackage(&amp;quot;com.xlsgrid.net.pub&amp;quot;);

var xmldb= new JavaPackage(&amp;quot;com.xlsgrid.net.xmldb&amp;quot;);
var xmldbpack = new JavaPackage ( &amp;quot;com.xlsgrid.net.xmldb&amp;quot; );
var iopack = new JavaPackage ( &amp;quot;java.io&amp;quot; );
var webpack = new JavaPackage ( &amp;quot;com.xlsgrid.net.web&amp;quot; );
var utilpack = new JavaPackage ( &amp;quot;java.util&amp;quot;);
var basePath = pubpack.EAOption.dynaDataRoot;
function addHeaderHtml(mwobj,request,sb,usrinfo)
//var sb = new java.lang.StringBuffer();var usrinfo = new web.EAUserinfo();
{
  
  sb.append(&amp;quot;&amp;lt;script&amp;gt;\n&amp;quot;);
  var thisorgid=pubpack.EAFunc.NVL(request.getParameter(&amp;quot;thisorgid&amp;quot;),webpack.EAWebDeforg.GetDeforg(request));
  sb.append(&amp;quot;\nvar thisorgid=\&amp;quot;&amp;quot;+thisorgid+&amp;quot;\&amp;quot;;&amp;quot;);
  sb.append(&amp;quot;&amp;lt;/script&amp;gt;&amp;quot;);
  
}
  
function afterBodyHtml(mwobj,request,sb,bodysb,usrinfo)
//var mwobj=grd.EAMidWareBase();var request=javax.servlet.http.HttpServletRequest();var sb = new java.lang.StringBuffer();var bodysb = new java.lang.StringBuffer();var usrinfo = new web.EAUserinfo();
{
  bodysb.insert(0,&amp;quot;&amp;lt;form id=\&amp;quot;myfilef\&amp;quot;&amp;gt;&amp;lt;input type=\&amp;quot;file\&amp;quot; id=\&amp;quot;myfile\&amp;quot; style=\&amp;quot;display:none\&amp;quot;&amp;gt;&amp;lt;/input&amp;gt;&amp;lt;/form&amp;gt;&amp;quot;);//
}  

// 复制xlsGridData到web
// 参数 deforg  sysurlid 
function copytoweb()
{
	var srcpath = basePath +&amp;quot;webresource/images/&amp;quot;+ deforg  + &amp;quot;/&amp;quot;+sysurlid+&amp;quot;/&amp;quot;; 
	var destpath = pubpack.EAOption.approot+&amp;quot;/images/&amp;quot;+ deforg  + &amp;quot;/&amp;quot;+sysurlid+&amp;quot;/&amp;quot;;
	pubpack.EAFunc.copyDirectiory(srcpath,destpath,&amp;quot;&amp;quot;,&amp;quot;CVS&amp;quot;,true );
	return &amp;quot;服务端：文件已从&amp;quot;+ srcpath +&amp;quot;同步到&amp;quot;+destpath ;
}

// 客户端param传入的参数可以直接使用
function save()
{
	var db = null;
	var sql= &amp;quot;&amp;quot;;
	var msg= &amp;quot;&amp;quot;;
	
	try {
		db = new pubpack.EADatabase();	// 如果连接到其他数据库, new pubpack.EADatabase(“dbname”)
		var ds = new pubpack.EAXmlDS(xmlstr);	// 客户端可以传入一个xml
		var EAfunc = new pubpack.EAFunc();
		
		for ( var row=0;row&amp;lt;ds.getRowCount();row ++ ) {
	
			var guid = ds.getStringAt(row,&amp;quot;GUID&amp;quot;);
			var org = ds.getStringAt(row,&amp;quot;ORG&amp;quot;);
			var refid = ds.getStringAt(row,&amp;quot;REFID&amp;quot;);
			var id = ds.getStringAt(row,&amp;quot;ID&amp;quot;);
			var name = ds.getStringAt(row,&amp;quot;NAME&amp;quot;);
			var note = ds.getStringAt(row,&amp;quot;NOTE&amp;quot;);
			var icon = ds.getStringAt(row,&amp;quot;ICON&amp;quot;);
			var icon2 = ds.getStringAt(row,&amp;quot;ICON2&amp;quot;);
			var seqid = ds.getStringAt(row,&amp;quot;SEQID&amp;quot;);
			var htmlguid = ds.getStringAt(row,&amp;quot;HTMLGUID&amp;quot;);
			var url = ds.getStringAt(row,&amp;quot;URL&amp;quot;);
			var target = ds.getStringAt(row,&amp;quot;TARGET&amp;quot;);
			var contextEs = ds.getStringAt(row,&amp;quot;contextEs&amp;quot;);
	

			
			if (guid != &amp;quot;&amp;quot;){
				sql = &amp;quot;update lsysurl set refid=&amp;apos;%s&amp;apos;,name=&amp;apos;%s&amp;apos;,note=&amp;apos;%s&amp;apos;,icon=&amp;apos;%s&amp;apos;,icon2=&amp;apos;%s&amp;apos;,seqid=&amp;apos;%s&amp;apos;,htmlguid =&amp;apos;%s&amp;apos;,url=&amp;apos;%s&amp;apos;,target=&amp;apos;%s&amp;apos;,contextEs=&amp;apos;%s&amp;apos; where guid=&amp;apos;%s&amp;apos;&amp;quot;
					.format([refid,name,note,icon,icon2,seqid,htmlguid,url,target,contextEs,guid]);
					
				db.ExcecutSQL(sql);
			} else {
				if (org != &amp;quot;&amp;quot; &amp;&amp; refid != &amp;quot;&amp;quot;) {
					sql = &amp;quot;insert into lsysurl (guid,org,refid,id,name,note,icon,icon2,seqid,htmlguid,url,target,contextEs) values (sys_guid(),&amp;apos;%s&amp;apos;,&amp;apos;%s&amp;apos;,&amp;apos;%s&amp;apos;,&amp;apos;%s&amp;apos;,&amp;apos;%s&amp;apos;,&amp;apos;%s&amp;apos;,&amp;apos;%s&amp;apos;,&amp;apos;%s&amp;apos;,&amp;apos;%s&amp;apos;,&amp;apos;%s&amp;apos;,&amp;apos;%s&amp;apos;,&amp;apos;%s&amp;apos;)&amp;quot;
						.format([org,refid,id,name,note,icon,icon2,seqid,htmlguid,url,target,contextEs]);
					db.ExcecutSQL(sql);
				}
			}
		}
		
		db.Commit();
		msg = &amp;quot;保存成功!&amp;quot;;
	}
	catch ( ee ) {
		db.Rollback();
		throw new pubpack.EAException ( ee.toString() );
	}
	finally {
		if (db!=null) db.Close();
	}
	return msg;
}

// 客户端param传入的参数可以直接使用
function delt()
{
	var db = null;
	var sql= &amp;quot;&amp;quot;;
	var cnt = 0;
	var msg= &amp;quot;&amp;quot;;
	
	try {
		db = new pubpack.EADatabase();	// 如果连接到其他数据库, new pubpack.EADatabase(“dbname”)
		var ds = new pubpack.EAXmlDS(xmlstr);	// 客户端可以传入一个xml
		
		for ( var row=0;row&amp;lt;ds.getRowCount();row ++ ) {
			var flg = ds.getStringAt(row,&amp;quot;FLG&amp;quot;);
			var guid = ds.getStringAt(row,&amp;quot;GUID&amp;quot;);
			
			if (flg == &amp;quot;1&amp;quot;) {
				sql = &amp;quot;delete from lsysurl where guid=&amp;apos;&amp;quot;+guid+&amp;quot;&amp;apos;&amp;quot;;
				cnt += db.ExcecutSQL(sql);
			}
		}
		
		db.Commit();
		msg = &amp;quot;删除成功! 共 &amp;quot;+cnt+&amp;quot; 行&amp;quot;;
	}
	catch ( ee ) {
		db.Rollback();
		throw new pubpack.EAException ( ee.toString() );
	}
	finally {
		if (db!=null) db.Close();
	}
	return msg;
}
</GRDOSDS_VALUE></ROW>
</ROWSET>
</grdosds><grddscds>
<ROWSET>
<ROW num="0" ><ID >Detail</ID><NAME ></NAME><DATDSC >select guid,org,refid,id,name,note,&amp;apos;&amp;apos; editflg,icon,&amp;apos;&amp;apos; b1,icon2,&amp;apos;&amp;apos; b2,seqid,url,target,HTMLGUID,CONTEXTES
  from LSYSURL
 where refid like &amp;apos;[%menu]%&amp;apos;   and (nvl(name,&amp;apos; &amp;apos;) like &amp;apos;%[%info]%&amp;apos; or nvl(note,&amp;apos; &amp;apos;) like &amp;apos;%[%info]%&amp;apos; or nvl(url,&amp;apos; &amp;apos;) like &amp;apos;%[%info]%&amp;apos; or nvl(refid,&amp;apos; &amp;apos;) like &amp;apos;%[%info]%&amp;apos;)
and org=&amp;apos;[%SYS_DEFORG]&amp;apos;
 order by org,refid,seqid</DATDSC><C4 >Detail</C4><C5 >Detail</C5><C6 >Detail</C6><C7 >Detail</C7><C8 >Detail</C8><C9 >Detail</C9><C10 >Detail</C10><C11 >Detail</C11><C12 >Detail</C12><C13 >Detail</C13><C14 >Detail</C14><C15 >Detail</C15><C16 >Detail</C16><C17 >Detail</C17></ROW>
<ROW num="1" ><ID >SEQ</ID><NAME ></NAME><DATDSC >select seq_sysurl.nextval from dual</DATDSC><C4 ></C4><C5 ></C5><C6 ></C6><C7 ></C7><C8 ></C8><C9 ></C9><C10 ></C10><C11 ></C11><C12 ></C12><C13 ></C13><C14 >SEQ</C14><C15 ></C15><C16 ></C16><C17 ></C17></ROW>
</ROWSET>
</grddscds><fldhdr>
<ROWSET>
<ROW num="0" ><BILID >1单据编号</BILID><STAT >0单据状态</STAT><SUBTYP >0子类型</SUBTYP><CORPID >0往来单位编号</CORPID><CORPNAM >0往来单位名称</CORPNAM><LOCID >0仓库|部门编号</LOCID><LOCNAM >0仓库|部门名称</LOCNAM><DAT >0单据日期</DAT><CRTUSR >1录入人</CRTUSR><CRTUSRNAM >0录入人姓名</CRTUSRNAM><CRTDAT >0录入日期</CRTDAT><CHKUSR >1审核人</CHKUSR><CHKUSRNAM >0审核人姓名</CHKUSRNAM><CHKDAT >0审核日期</CHKDAT><SUMQTY >0合计金额</SUMQTY><SUMMNY >0合计金额</SUMMNY><REFID1 >0扩展字段</REFID1><REFNAM1 >0扩展字段</REFNAM1><REFID2 >0扩展字段</REFID2><REFNAM2 >0扩展字段</REFNAM2><REFID3 >0扩展字段</REFID3><REFNAM3 >0扩展字段</REFNAM3><REFID4 >0扩展字段</REFID4><REFNAM4 >0扩展字段</REFNAM4><REFID5 >0扩展字段</REFID5><REFNAM5 >0扩展字段</REFNAM5><REFID6 >0扩展字段</REFID6><REFNAM6 >0扩展字段</REFNAM6><NOTE >0备注</NOTE></ROW>
</ROWSET>
</fldhdr><flddtl>
<ROWSET>
<ROW num="0" ><SEQID >1明细序号</SEQID><ITMID >1品种编号</ITMID><ITMNAM >0品种名称</ITMNAM><ITEMPC >0品种批次号</ITEMPC><ITMSPC >0规格</ITMSPC><UNIT >0计量单位</UNIT><SMLUNT >0小计量单位</SMLUNT><UNTNUM >0大单位转小单位因子</UNTNUM><PRICE >0价格</PRICE><QTY >0数量</QTY><TAXTYP >0税率类型</TAXTYP><NOTAXMNY >0不含税税额</NOTAXMNY><TAXMNY >0税额</TAXMNY><MNY >0下单金额</MNY><REFID1 >0扩展字段</REFID1><REFNAM1 >0扩展字段</REFNAM1><REFID2 >0扩展字段</REFID2><REFNAM2 >0扩展字段</REFNAM2><REFID3 >0扩展字段</REFID3><REFNAM3 >0扩展字段</REFNAM3><REFID4 >0扩展字段</REFID4><REFNAM4 >0扩展字段</REFNAM4><REFID5 >0扩展字段</REFID5><REFNAM5 >0扩展字段</REFNAM5></ROW>
</ROWSET>
</flddtl></mdroot>