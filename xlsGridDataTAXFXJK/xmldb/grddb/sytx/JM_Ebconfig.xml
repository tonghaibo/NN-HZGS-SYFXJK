<?xml version='1.0' encoding='GBK'?><mdroot><grdds>
<ROWSET>
<ROW num="0" ><MWTYP >R</MWTYP><MWID >JM_Ebconfig</MWID><NAME >网站抓取密码设置</NAME><NOTE ></NOTE><NOACCNAME ></NOACCNAME><FILE >JM_Ebconfig.zxg</FILE><SCENE >10</SCENE><FIXED >1,2</FIXED><CATTYP ></CATTYP><DTLRNG ></DTLRNG><BATINP ></BATINP><MANUNIT ></MANUNIT><USESMLUNT ></USESMLUNT><ITEMTABLE ></ITEMTABLE><BILHDRTABLE ></BILHDRTABLE><BILDTLTABLE ></BILDTLTABLE><COLLIST ></COLLIST><WHERE ></WHERE><ORDER ></ORDER><DBNAME ></DBNAME><LISTSUM ></LISTSUM><LOADDATA ></LOADDATA><CHECKTITLE ></CHECKTITLE><IFBILL ></IFBILL><EXTJS ></EXTJS><JAVACLS ></JAVACLS><POST2MWID ></POST2MWID><LMS ></LMS><syt >x</syt><WIDTHMOD >1</WIDTHMOD><HEIGHTMOD >1</HEIGHTMOD></ROW>
</ROWSET>
</grdds><grdcelds>
<ROWSET>
<ROW num="0" ><ID >0,1,2</ID><CELLID ></CELLID><NAME ></NAME><VALFLD ></VALFLD><DEFVAL ></DEFVAL><NOTNULL ></NOTNULL><VALTYP ></VALTYP><MAXLEN ></MAXLEN><CTLTYP >COMBOBOX</CTLTYP><LISTID >V_KA</LISTID><WHERE ></WHERE><ORDER ></ORDER><IFQUERY ></IFQUERY><IFQUERYSCOPE ></IFQUERYSCOPE><QUERTDEFVAL ></QUERTDEFVAL><FLD ></FLD><C17 >0,1,1</C17><C18 >0,1,2</C18><C19 ></C19></ROW>
</ROWSET>
</grdcelds><grdbtnds>
<ROWSET>
<ROW num="0" ><ID >save</ID><NAME >保存</NAME><ACTTYP ></ACTTYP><URL ></URL><URLTARGET ></URLTARGET><TIP ></TIP><BTNORD >0</BTNORD><IMG ></IMG><IMGMOUSE ></IMGMOUSE><C10 >save</C10></ROW>
</ROWSET>
</grdbtnds><grdpamds>
<ROWSET>
<ROW num="0" ><ID >guid</ID><NAME ></NAME><NOTNULL ></NOTNULL><KEYVAL ></KEYVAL><INPCTL ></INPCTL><DISPORD ></DISPORD><SQLWHE ></SQLWHE><DEFVAL ></DEFVAL><TIP ></TIP><EDTFLG ></EDTFLG><VISFLG ></VISFLG><KEYFLG ></KEYFLG><C13 >hdrguid</C13><C14 >hdrguid</C14><C15 ></C15><C16 >guid</C16></ROW>
<ROW num="1" ><ID >style</ID><NAME ></NAME><NOTNULL ></NOTNULL><KEYVAL ></KEYVAL><INPCTL ></INPCTL><DISPORD ></DISPORD><SQLWHE ></SQLWHE><DEFVAL ></DEFVAL><TIP ></TIP><EDTFLG ></EDTFLG><VISFLG ></VISFLG><KEYFLG ></KEYFLG><C13 >style</C13><C14 >style</C14><C15 ></C15><C16 ></C16></ROW>
<ROW num="2" ><ID >prjid</ID><NAME ></NAME><NOTNULL ></NOTNULL><KEYVAL ></KEYVAL><INPCTL ></INPCTL><DISPORD ></DISPORD><SQLWHE ></SQLWHE><DEFVAL ></DEFVAL><TIP ></TIP><EDTFLG ></EDTFLG><VISFLG ></VISFLG><KEYFLG ></KEYFLG><C13 >prjid</C13><C14 >prjid</C14><C15 >prjid</C15><C16 ></C16></ROW>
<ROW num="3" ><ID >edit</ID><NAME ></NAME><NOTNULL ></NOTNULL><KEYVAL ></KEYVAL><INPCTL ></INPCTL><DISPORD ></DISPORD><SQLWHE ></SQLWHE><DEFVAL ></DEFVAL><TIP ></TIP><EDTFLG ></EDTFLG><VISFLG ></VISFLG><KEYFLG ></KEYFLG><C13 ></C13><C14 >edit</C14><C15 ></C15><C16 ></C16></ROW>
<ROW num="4" ><ID >hdrordtl</ID><NAME ></NAME><NOTNULL ></NOTNULL><KEYVAL ></KEYVAL><INPCTL ></INPCTL><DISPORD ></DISPORD><SQLWHE ></SQLWHE><DEFVAL ></DEFVAL><TIP ></TIP><EDTFLG ></EDTFLG><VISFLG ></VISFLG><KEYFLG ></KEYFLG><C13 >hdrordtl</C13><C14 ></C14><C15 ></C15><C16 ></C16></ROW>
<ROW num="5" ><ID >tousrid</ID><NAME ></NAME><NOTNULL ></NOTNULL><KEYVAL ></KEYVAL><INPCTL ></INPCTL><DISPORD ></DISPORD><SQLWHE ></SQLWHE><DEFVAL ></DEFVAL><TIP ></TIP><EDTFLG ></EDTFLG><VISFLG ></VISFLG><KEYFLG ></KEYFLG><C13 ></C13><C14 ></C14><C15 ></C15><C16 ></C16></ROW>
</ROWSET>
</grdpamds><grdshwds>
<ROWSET>
<ROW num="0" ><ID >0,0,2</ID><NAME ></NAME><DBNAME ></DBNAME><DSKEY >DSC:MAIN</DSKEY><NROW >4</NROW><NCOL >4</NCOL><PAGES ></PAGES><PAGESIZE ></PAGESIZE><URL ></URL><CTLTYP ></CTLTYP><DYNCTL ></DYNCTL><LISTID ></LISTID><ISCROSS ></ISCROSS><HROW ></HROW><HCOLS ></HCOLS><ROWORDER ></ROWORDER><VCOLS ></VCOLS><VCOLSQL ></VCOLSQL><VALUECOL ></VALUECOL><C20 ></C20><C21 ></C21><C22 ></C22><C23 ></C23><C24 ></C24><C25 ></C25><C26 ></C26><C27 ></C27><C28 ></C28><C29 ></C29><C30 >0,1,2</C30><C31 >0,1,1</C31></ROW>
</ROWSET>
</grdshwds><grdjsds>
<ROWSET>
<ROW num="0" ><GRDJSDS_VALUE ></GRDJSDS_VALUE></ROW>
</ROWSET>
</grdjsds><grdosds>
<ROWSET>
<ROW num="0" ><GRDOSDS_VALUE >var pubpack=new JavaPackage(&amp;quot;com.xlsgrid.net.pub&amp;quot;);
var baskpack=new JavaPackage(&amp;quot;com.xlsgrid.net&amp;quot;);
//var servletpack=new JavaPackage(&amp;quot;com.xlsgrid.net.servlet&amp;quot;);
var web=new JavaPackage(&amp;quot;com.xlsgrid.net.web&amp;quot;);

function Response()
{
	var func=pubpack.EAFunc.NVL(request.getParameter(&amp;quot;func&amp;quot;),&amp;quot;&amp;quot;);//获取执行的函数名称如:save
	var data=pubpack.EAFunc.NVL(request.getParameter(&amp;quot;_this&amp;quot;),&amp;quot;&amp;quot;);//获取提交的数据.是一个xml
	var corpid=pubpack.EAFunc.NVL(request.getParameter(&amp;quot;CORPID&amp;quot;),&amp;quot;&amp;quot;);
	var locid=pubpack.EAFunc.NVL(request.getParameter(&amp;quot;LOCID&amp;quot;),&amp;quot;&amp;quot;);
	var corpsoid = pubpack.EAFunc.NVL(request.getParameter(&amp;quot;CORPSOID&amp;quot;),&amp;quot;&amp;quot;);
	//throw new Exception (&amp;quot;func=&amp;quot;+func);
	var usr=web.EASession.GetLoginInfo(request);//获取当前用户信息
	var usrid = usr.getUsrid();
	var accid = usr.getAccid();
	var sytid = usr.getSytid();
	var orgid = usr.getOrgid();
	var db = null;//数据库
	var selforg = orgid; 
	var aimorg = orgid; 
	var acc = accid;
	var syt = sytid;
	var crtusr = usrid;
	//读取参数
	//show.sp?grdid=HDRTRK&amp;hdrordtl=2&amp;hdrguid=984E55D55B624F4ABB70F88CDD3CC36D&amp;style=31&amp;prjid=TRA&amp;edit=&amp;dd=
	var xml=&amp;quot;&amp;quot;;
	xml=pubpack.EAJ2meUtil.getMainCellRangeXml(data);
	var row=xml.getRowCount();
	var col=xml.getColumnCount();
	var HDRORDTL = &amp;quot;&amp;quot;;
	try {
		HDRORDTL  = xml.get(0,1) ;
		if(HDRORDTL==&amp;quot;&amp;quot;)HDRORDTL=&amp;quot;1&amp;quot;;
	} catch ( e ) {HDRORDTL=&amp;quot;1&amp;quot;;}
	
	
	//
	var kaid = &amp;quot;&amp;quot;;
	try{ kaid = xml.get(1,3); }catch(ee){kaid=&amp;quot;error&amp;quot;;}//当全部为空值时,会xml.get(0,3)抛出错误
	
	if(kaid != &amp;quot;error&amp;quot;){
		
		hdrguid = xml.get(0,3) ;//获取处理事务的hdrguid
		//show = xml.get(0,2) ;//获取事务类型
		//if(show == &amp;quot;&amp;quot;)show = &amp;quot;2&amp;quot;;
		//edit=&amp;quot;save&amp;quot;;//save 保存 modify 修改 
		var usrid = xml.get(2,3);
		var passwd = xml.get(3,3);
		var note = xml.get(4,3);
		throw new Exception(hdrguid+&amp;quot;|&amp;quot;+ kaid+&amp;quot;|&amp;quot;+usrid+&amp;quot;|&amp;quot;+passwd+&amp;quot;|&amp;quot;+note);
		var empty = false;
		if(kaid==&amp;quot;&amp;quot;){
			out.println(&amp;quot;您没有选择渠道&amp;quot;);
			empty = true;
		}
		if(usrid ==&amp;quot;&amp;quot;){
			out.println(&amp;quot;您没有输入登录帐号&amp;quot;);
			empty = true;
		}
		if(kapasswd==&amp;quot;&amp;quot;){
			out.println(&amp;quot;您没有输入登录密码&amp;quot;);
			empty = true;
		}
		if(empty != true){
			try
		        {
		            db = new pubpack.EADatabase();
		            if(hdrguid==&amp;quot;&amp;quot;){
		            	  var sql = &amp;quot;insert into ebconfig(userid,passwd,kaid,note,acc) values (?,?,?,?,?) &amp;quot;;
		                  var ps2 = db.prepareStatement(sql);
		                  ps2.setString(1,usrid);
		                  ps2.setString(2,passwd);
				  ps2.setString(3,kaid);
				  ps2.setString(4,note);
				  ps2.setString(5,&amp;quot;jqpx&amp;quot;);
		
		                  ps2.executeUpdate();
		                  ps2.close();
		                  //throw new Exception(sql);
		            }else{
		            	var sql = &amp;quot;update ebconfig set userid=?,passwd=?,kaid=?,note=?,acc=? where guid=&amp;apos;&amp;quot;+hdrguid+&amp;quot;&amp;apos;&amp;quot;;
		            	 var ps2 = db.prepareStatement(sql);
		                  ps2.setString(1,usrid);
		                  ps2.setString(2,passwd);
				  ps2.setString(3,kaid);
				  ps2.setString(4,note);
				  ps2.setString(5,&amp;quot;jqpx&amp;quot;);
		
		                  ps2.executeUpdate();
		                  ps2.close();
		                  throw new Exception(sql+&amp;quot;|&amp;quot;+hdrguid);
		            }
		                  
		                  //throw new Exception(sql);
				//return ret ;
		      }
		      catch(e)
		      {
		      	if( db!= null ) db.Rollback();
		
		            throw e;
		      }
		      finally
		      {
		            db.Close(); 
		      }       
	
			out.println(&amp;quot;保存成功&amp;quot;);
		}
	      
		
//		if((project==&amp;quot;&amp;quot;||dtlusr==&amp;quot;&amp;quot;||title==&amp;quot;&amp;quot;)&amp;&amp;(HDRORDTL==&amp;quot;1&amp;quot;||HDRORDTL==&amp;quot;2&amp;quot;)){
//			if(project==&amp;quot;&amp;quot;)out.println(&amp;quot;项目不能为空值&amp;quot;);
//			if(dtlusr==&amp;quot;&amp;quot;)out.println(&amp;quot;发送人不能为空值&amp;quot;);
//			if(title==&amp;quot;&amp;quot;)out.println(&amp;quot;标题不能为空值&amp;quot;);
//		}else if(HDRORDTL==&amp;quot;3&amp;quot;||title==&amp;quot;&amp;quot;){
//			if(title==&amp;quot;&amp;quot;)out.println(&amp;quot;标题不能为空值&amp;quot;);
//		}else if(project==&amp;quot;&amp;quot;||dtlusr==&amp;quot;&amp;quot;||title==&amp;quot;&amp;quot;){
//			if(project==&amp;quot;&amp;quot;)out.println(&amp;quot;项目不能为空值&amp;quot;);
//			if(dtlusr==&amp;quot;&amp;quot;)out.println(&amp;quot;发送人不能为空值&amp;quot;);
//			if(title==&amp;quot;&amp;quot;)out.println(&amp;quot;标题不能为空值&amp;quot;);
//		}else{
//			var out=response.getOutputStream();
//			response.setContentType(&amp;quot;content-type:text/html; charset=UTF-8&amp;quot;);
//			out.println(&amp;quot;show=&amp;quot;+show+&amp;quot;hdrguid=&amp;quot;+hdrguid+&amp;quot;prject=&amp;quot;+project+&amp;quot;sendto=&amp;quot;+dtlusr+&amp;quot;title=&amp;quot;+title+&amp;quot;note=&amp;quot;+note+&amp;quot;HDRORDTL=&amp;quot;+HDRORDTL);//out.println();
//			//throw new Exception(&amp;quot;prject=&amp;quot;+prject+&amp;quot;sendto=&amp;quot;+sendto+&amp;quot;smssign=&amp;quot;+smssign+&amp;quot;mailsign=&amp;quot;+mailsign+&amp;quot;title=&amp;quot;+title+&amp;quot;note=&amp;quot;+note);
//			//在服务端OS中引用其他中间件的服务端脚本
//			//说明：x_SQLINPUT是指x系统SQLINPUT中间件
//			var parent = new XLSGRID_HDRTRK();
//			//parent.save1();
//			if(HDRORDTL==&amp;quot;1&amp;quot;){
//				parent.save1();
//			}else if (HDRORDTL==&amp;quot;2&amp;quot;){
//				parent.save2();
//			}else if (HDRORDTL==&amp;quot;3&amp;quot;){
//				parent.save3();
//			}
//		}
		
		
	}else{
		if(kaid==&amp;quot;error&amp;quot;)out.println(&amp;quot;你没有填任何信息&amp;quot;);
	}

	
	
	

}</GRDOSDS_VALUE></ROW>
</ROWSET>
</grdosds><grddscds>
<ROWSET>
<ROW num="0" ><ID >MAIN</ID><NAME ></NAME><DATDSC >select &amp;apos;[%guid]&amp;apos;from dual
union all SELECT trim(KAID) FROM ebconfig where guid=&amp;apos;[%guid]&amp;apos;
UNION ALL SELECT USERID FROM ebconfig where guid=&amp;apos;[%guid]&amp;apos;
UNION ALL SELECT PASSWD FROM ebconfig where guid=&amp;apos;[%guid]&amp;apos;
UNION ALL SELECT NOTE FROM ebconfig where guid=&amp;apos;[%guid]&amp;apos;
</DATDSC><C4 ></C4><C5 ></C5><C6 ></C6><C7 ></C7><C8 ></C8><C9 >MAIN</C9><C10 >MAIN</C10></ROW>
</ROWSET>
</grddscds><fldhdr>
<ROWSET>
<ROW num="0" ><BILID >1单据编号</BILID><STAT >0单据状态</STAT><SUBTYP >0子类型</SUBTYP><CORPID >0往来单位编号</CORPID><CORPNAM >0往来单位名称</CORPNAM><LOCID >0仓库|部门编号</LOCID><LOCNAM >0仓库|部门名称</LOCNAM><DAT >0单据日期</DAT><CRTUSR >1录入人</CRTUSR><CRTUSRNAM >0录入人姓名</CRTUSRNAM><CRTDAT >0录入日期</CRTDAT><CHKUSR >1审核人</CHKUSR><CHKUSRNAM >0审核人姓名</CHKUSRNAM><CHKDAT >0审核日期</CHKDAT><SUMQTY >0合计金额</SUMQTY><SUMMNY >0合计金额</SUMMNY><REFID1 >0扩展字段</REFID1><REFNAM1 >0扩展字段</REFNAM1><REFID2 >0扩展字段</REFID2><REFNAM2 >0扩展字段</REFNAM2><REFID3 >0扩展字段</REFID3><REFNAM3 >0扩展字段</REFNAM3><REFID4 >0扩展字段</REFID4><REFNAM4 >0扩展字段</REFNAM4><REFID5 >0扩展字段</REFID5><REFNAM5 >0扩展字段</REFNAM5><REFID6 >0扩展字段</REFID6><REFNAM6 >0扩展字段</REFNAM6><NOTE >0备注</NOTE></ROW>
</ROWSET>
</fldhdr><flddtl>
<ROWSET>
<ROW num="0" ><SEQID >1明细序号</SEQID><ITMID >1品种编号</ITMID><ITMNAM >0品种名称</ITMNAM><ITEMPC >0品种批次号</ITEMPC><ITMSPC >0规格</ITMSPC><UNIT >0计量单位</UNIT><SMLUNT >0小计量单位</SMLUNT><UNTNUM >0大单位转小单位因子</UNTNUM><PRICE >0价格</PRICE><QTY >0数量</QTY><TAXTYP >0税率类型</TAXTYP><NOTAXMNY >0不含税税额</NOTAXMNY><TAXMNY >0税额</TAXMNY><MNY >0下单金额</MNY><REFID1 >0扩展字段</REFID1><REFNAM1 >0扩展字段</REFNAM1><REFID2 >0扩展字段</REFID2><REFNAM2 >0扩展字段</REFNAM2><REFID3 >0扩展字段</REFID3><REFNAM3 >0扩展字段</REFNAM3><REFID4 >0扩展字段</REFID4><REFNAM4 >0扩展字段</REFNAM4><REFID5 >0扩展字段</REFID5><REFNAM5 >0扩展字段</REFNAM5></ROW>
</ROWSET>
</flddtl></mdroot>