<?xml version='1.0' encoding='GBK'?><mdroot><grdds>
<ROWSET>
<ROW num="0" ><MWTYP >F</MWTYP><MWID >LHTMLEDIT</MWID><NAME >页面显示风格定义</NAME><NOTE ></NOTE><NOACCNAME ></NOACCNAME><FILE >LHTMLEDIT.zxg</FILE><SCENE ></SCENE><FIXED ></FIXED><CATTYP ></CATTYP><DTLRNG >14,3,19,7</DTLRNG><BATINP ></BATINP><MANUNIT ></MANUNIT><USESMLUNT ></USESMLUNT><ITEMTABLE ></ITEMTABLE><BILHDRTABLE >LHTML</BILHDRTABLE><BILDTLTABLE >LHTMLDTL</BILDTLTABLE><COLLIST ></COLLIST><WHERE >1=1</WHERE><ORDER ></ORDER><DBNAME ></DBNAME><LISTSUM ></LISTSUM><LOADDATA ></LOADDATA><CHECKTITLE ></CHECKTITLE><IFBILL ></IFBILL><EXTJS ></EXTJS><JAVACLS ></JAVACLS><POST2MWID ></POST2MWID><LMS ></LMS><WIDTHMOD >1</WIDTHMOD><HEIGHTMOD ></HEIGHTMOD><CLIENTCLASS ></CLIENTCLASS><SHOWBTN ></SHOWBTN><CLOSEPAGES ></CLOSEPAGES><syt >x</syt></ROW>
</ROWSET>
</grdds><grdcelds>
<ROWSET>
<ROW num="0" ><ID >0,5,3</ID><CELLID ></CELLID><NAME >编号</NAME><VALFLD >ID</VALFLD><DEFVAL ></DEFVAL><NOTNULL ></NOTNULL><VALTYP ></VALTYP><MAXLEN ></MAXLEN><CTLTYP ></CTLTYP><LISTID ></LISTID><WHERE ></WHERE><ORDER ></ORDER><IFQUERY >1</IFQUERY><IFQUERYSCOPE ></IFQUERYSCOPE><QUERTDEFVAL ></QUERTDEFVAL><FLD ></FLD><C17 ></C17><C18 ></C18></ROW>
<ROW num="1" ><ID >0,5,6</ID><CELLID ></CELLID><NAME >名称</NAME><VALFLD >NAME</VALFLD><DEFVAL ></DEFVAL><NOTNULL ></NOTNULL><VALTYP ></VALTYP><MAXLEN ></MAXLEN><CTLTYP ></CTLTYP><LISTID ></LISTID><WHERE ></WHERE><ORDER ></ORDER><IFQUERY >1</IFQUERY><IFQUERYSCOPE ></IFQUERYSCOPE><QUERTDEFVAL ></QUERTDEFVAL><FLD ></FLD><C17 ></C17><C18 ></C18></ROW>
<ROW num="2" ><ID >0,5,10</ID><CELLID ></CELLID><NAME >分类</NAME><VALFLD >CLS</VALFLD><DEFVAL ></DEFVAL><NOTNULL ></NOTNULL><VALTYP ></VALTYP><MAXLEN ></MAXLEN><CTLTYP ></CTLTYP><LISTID ></LISTID><WHERE ></WHERE><ORDER ></ORDER><IFQUERY >1</IFQUERY><IFQUERYSCOPE ></IFQUERYSCOPE><QUERTDEFVAL ></QUERTDEFVAL><FLD ></FLD><C17 ></C17><C18 ></C18></ROW>
<ROW num="3" ><ID >0,7,3</ID><CELLID ></CELLID><NAME >中间件系统号</NAME><VALFLD >OSSYT</VALFLD><DEFVAL ></DEFVAL><NOTNULL ></NOTNULL><VALTYP ></VALTYP><MAXLEN ></MAXLEN><CTLTYP ></CTLTYP><LISTID ></LISTID><WHERE ></WHERE><ORDER ></ORDER><IFQUERY >1</IFQUERY><IFQUERYSCOPE ></IFQUERYSCOPE><QUERTDEFVAL ></QUERTDEFVAL><FLD ></FLD><C17 ></C17><C18 ></C18></ROW>
<ROW num="4" ><ID >0,7,6</ID><CELLID ></CELLID><NAME >中间件编号</NAME><VALFLD >OSMWID</VALFLD><DEFVAL ></DEFVAL><NOTNULL ></NOTNULL><VALTYP ></VALTYP><MAXLEN ></MAXLEN><CTLTYP ></CTLTYP><LISTID ></LISTID><WHERE ></WHERE><ORDER ></ORDER><IFQUERY ></IFQUERY><IFQUERYSCOPE ></IFQUERYSCOPE><QUERTDEFVAL ></QUERTDEFVAL><FLD ></FLD><C17 ></C17><C18 ></C18></ROW>
<ROW num="5" ><ID >0,7,10</ID><CELLID ></CELLID><NAME >中间件方法名</NAME><VALFLD >OSFUNC</VALFLD><DEFVAL >GetBody</DEFVAL><NOTNULL ></NOTNULL><VALTYP ></VALTYP><MAXLEN ></MAXLEN><CTLTYP ></CTLTYP><LISTID ></LISTID><WHERE ></WHERE><ORDER ></ORDER><IFQUERY ></IFQUERY><IFQUERYSCOPE ></IFQUERYSCOPE><QUERTDEFVAL ></QUERTDEFVAL><FLD ></FLD><C17 ></C17><C18 ></C18></ROW>
<ROW num="6" ><ID >0,11,3</ID><CELLID ></CELLID><NAME >说明</NAME><VALFLD >NOTE</VALFLD><DEFVAL ></DEFVAL><NOTNULL ></NOTNULL><VALTYP ></VALTYP><MAXLEN ></MAXLEN><CTLTYP >CODEEDITOR</CTLTYP><LISTID ></LISTID><WHERE ></WHERE><ORDER ></ORDER><IFQUERY ></IFQUERY><IFQUERYSCOPE ></IFQUERYSCOPE><QUERTDEFVAL ></QUERTDEFVAL><FLD ></FLD><C17 ></C17><C18 >0,9,3</C18></ROW>
<ROW num="7" ><ID >0,9,3</ID><CELLID ></CELLID><NAME >缩略图</NAME><VALFLD >PREVIEWS</VALFLD><DEFVAL ></DEFVAL><NOTNULL ></NOTNULL><VALTYP ></VALTYP><MAXLEN ></MAXLEN><CTLTYP ></CTLTYP><LISTID ></LISTID><WHERE ></WHERE><ORDER ></ORDER><IFQUERY ></IFQUERY><IFQUERYSCOPE ></IFQUERYSCOPE><QUERTDEFVAL ></QUERTDEFVAL><FLD ></FLD><C17 ></C17><C18 >0,10,3</C18></ROW>
<ROW num="8" ><ID >0,3,7</ID><CELLID ></CELLID><NAME >制单人1</NAME><VALFLD >CRTUSR</VALFLD><DEFVAL ></DEFVAL><NOTNULL ></NOTNULL><VALTYP ></VALTYP><MAXLEN ></MAXLEN><CTLTYP ></CTLTYP><LISTID ></LISTID><WHERE ></WHERE><ORDER ></ORDER><IFQUERY ></IFQUERY><IFQUERYSCOPE ></IFQUERYSCOPE><QUERTDEFVAL ></QUERTDEFVAL><FLD ></FLD><C17 >0,3,7</C17><C18 ></C18></ROW>
<ROW num="9" ><ID >0,9,10</ID><CELLID ></CELLID><NAME >CSSFILE</NAME><VALFLD >CSSFILE</VALFLD><DEFVAL ></DEFVAL><NOTNULL ></NOTNULL><VALTYP ></VALTYP><MAXLEN ></MAXLEN><CTLTYP ></CTLTYP><LISTID ></LISTID><WHERE ></WHERE><ORDER ></ORDER><IFQUERY ></IFQUERY><IFQUERYSCOPE ></IFQUERYSCOPE><QUERTDEFVAL ></QUERTDEFVAL><FLD ></FLD><C17 ></C17><C18 ></C18></ROW>
<ROW num="10" ><ID >0,9,11</ID><CELLID ></CELLID><NAME >JSFILEPATH</NAME><VALFLD >JSFILE</VALFLD><DEFVAL ></DEFVAL><NOTNULL ></NOTNULL><VALTYP ></VALTYP><MAXLEN ></MAXLEN><CTLTYP ></CTLTYP><LISTID ></LISTID><WHERE ></WHERE><ORDER ></ORDER><IFQUERY ></IFQUERY><IFQUERYSCOPE ></IFQUERYSCOPE><QUERTDEFVAL ></QUERTDEFVAL><FLD ></FLD><C17 ></C17><C18 ></C18></ROW>
</ROWSET>
</grdcelds><grdcolds>
<ROWSET>
<ROW num="0" ><ID >0,3</ID><NAME >参数编号</NAME><VALFLD >ID</VALFLD><NOTNULL ></NOTNULL><COLTYP ></COLTYP><LISTID ></LISTID><LABEL ></LABEL><ISIDX ></ISIDX><INDEXID ></INDEXID><WHERE ></WHERE><ORDER ></ORDER><FLD ></FLD></ROW>
<ROW num="1" ><ID >0,5</ID><NAME >参数名称</NAME><VALFLD >NAME</VALFLD><NOTNULL ></NOTNULL><COLTYP ></COLTYP><LISTID ></LISTID><LABEL ></LABEL><ISIDX ></ISIDX><INDEXID ></INDEXID><WHERE ></WHERE><ORDER ></ORDER><FLD ></FLD></ROW>
<ROW num="2" ><ID >0,7</ID><NAME >参数说明</NAME><VALFLD >MEMO</VALFLD><NOTNULL ></NOTNULL><COLTYP ></COLTYP><LISTID ></LISTID><LABEL ></LABEL><ISIDX ></ISIDX><INDEXID ></INDEXID><WHERE ></WHERE><ORDER ></ORDER><FLD ></FLD></ROW>
</ROWSET>
</grdcolds><grdbtnds>
<ROWSET>
<ROW num="0" ><ID >test</ID><NAME >测试</NAME><ACTTYP ></ACTTYP><URL ></URL><URLTARGET ></URLTARGET><TIP ></TIP><BTNORD ></BTNORD><IMG ></IMG><IMGMOUSE ></IMGMOUSE><C10 >test</C10><C11 ></C11><C12 >test</C12><C13 >test</C13><C14 >test</C14></ROW>
</ROWSET>
</grdbtnds><grdjsds>
<ROWSET>
<ROW num="0" ><GRDJSDS_VALUE >var G_IMAGEMENUXML = &amp;quot;&amp;lt;item id=\&amp;quot;m_img_select\&amp;quot; name=\&amp;quot;选择WEB图片\&amp;quot;/&amp;gt;&amp;lt;item id=\&amp;quot;m_img_selectlib\&amp;quot; name=\&amp;quot;选择图库\&amp;quot;/&amp;gt;&amp;lt;item id=\&amp;quot;m_img_modify\&amp;quot; name=\&amp;quot;编辑图片\&amp;quot;/&amp;gt;&amp;lt;item id=\&amp;quot;m_img_preview\&amp;quot; name=\&amp;quot;预览图片\&amp;quot;/&amp;gt;&amp;lt;item id=\&amp;quot;m_img_upload\&amp;quot; name=\&amp;quot;选择本地图片上传\&amp;quot;/&amp;gt;&amp;quot;;
var sheet0=0;
var sheet1=1;
var sheet2=2;

function _thisOnpost_loaddata(sheet)
{
	_this.SetToButton(&amp;quot;&amp;quot;,0,9,7,&amp;quot;&amp;quot;,&amp;quot;&amp;quot;,G_IMAGEMENUXML,0,16,16);
//	if(_this.GetCellText(sheet0,3,3)==&amp;quot;&amp;quot;){
//		_this.SetCellText(sheet0,3,3,G_ACCID);
//	}
//	if(_this.GetCellText(sheet0,3,4)==&amp;quot;&amp;quot;){
//		_this.SetCellText(sheet0,3,4,G_ORGID);
//	}
//	if(_this.GetCellText(sheet0,3,5)==&amp;quot;&amp;quot;){
//		_this.SetCellText(sheet0,3,5,G_SYTID);
//	}
//	if(_this.GetCellText(sheet0,3,7)==&amp;quot;&amp;quot;){
//		_this.SetCellText(sheet0,3,7,G_USRID);
//	}
	sheet1 = _this.AddSheet(&amp;quot;CSS&amp;quot;);
	
	sheet2 = _this.AddSheet(&amp;quot;JS&amp;quot;);
	var thissytid = _this.GetCellText(0,7,3);
	var thisid = _this.GetCellText(0,5,3);
	if(thissytid!=&amp;quot;&amp;quot; &amp;&amp; thisid!=&amp;quot;&amp;quot;){
		try {
			var css = invokeOSFunc(&amp;quot;GetCSS&amp;quot;,&amp;quot;thisid=&amp;quot;+thisid+&amp;quot;&amp;thissytid=&amp;quot;+thissytid) ;       
			_this.LogString(css);
			_this.SetToCodeEditor(&amp;quot;&amp;quot;,sheet1,-1,-1,css,&amp;quot;&amp;quot;,&amp;quot;&amp;quot;);
			
		}
		catch ( e ) {
			_this.SetToCodeEditor(&amp;quot;&amp;quot;,sheet1,-1,-1,&amp;quot;&amp;quot;,&amp;quot;&amp;quot;,&amp;quot;&amp;quot;);
			_this.LogString(e);
		}
		try {
			
			var js = invokeOSFunc(&amp;quot;GetJS&amp;quot;,&amp;quot;thisid=&amp;quot;+thisid+&amp;quot;&amp;thissytid=&amp;quot;+thissytid) ;       
			_this.LogString(js);
			_this.SetToCodeEditor(&amp;quot;&amp;quot;,sheet2,-1,-1,js,&amp;quot;&amp;quot;,&amp;quot;&amp;quot;);
		}
		catch ( e ) {
			_this.SetToCodeEditor(&amp;quot;&amp;quot;,sheet2,-1,-1,&amp;quot;&amp;quot;,&amp;quot;&amp;quot;,&amp;quot;&amp;quot;);

			_this.LogString(e);
		}

	}
	else {
		_this.SetToCodeEditor(&amp;quot;&amp;quot;,sheet1,-1,-1,&amp;quot;&amp;quot;,&amp;quot;&amp;quot;,&amp;quot;&amp;quot;);
		_this.SetToCodeEditor(&amp;quot;&amp;quot;,sheet2,-1,-1,&amp;quot;&amp;quot;,&amp;quot;&amp;quot;,&amp;quot;&amp;quot;);
	
	
	}
	_this.SetSheetName(sheet0,&amp;quot;设计主页&amp;quot;);
	_this.ShowTabBar(1);
}



//点击菜单项
function _thisOnMenuItemSelect(sheet,row,col,menuitemid)
{
	var id=menuitemid;
	//&amp;quot;&amp;lt;item id=\&amp;quot;m_img_select\&amp;quot; name=\&amp;quot;选择图片\&amp;quot;/&amp;gt;&amp;lt;item id=\&amp;quot;m_img_modify\&amp;quot; name=\&amp;quot;编辑图片\&amp;quot;/&amp;gt;&amp;lt;item id=\&amp;quot;m_img_preview\&amp;quot; name=\&amp;quot;预览图片\&amp;quot;/&amp;gt;&amp;quot;;

	if(id==&amp;quot;m_img_modify&amp;quot;){//编辑图片
		
		var imgurl = GetImageURL (sheet,row,col);
		
		var imgguid = &amp;quot;&amp;quot;;
		var prestr = &amp;quot;EAFormBlob.sp?guid=&amp;quot;;
		if(imgurl.substring(0,prestr.length)==prestr){
			imgguid = imgurl.substring(prestr.length );
		}
		try{
			var bw = _this.GetCellText(sheet,row+1,2);
			var bh = _this.GetCellText(sheet,row+1,3);
			if(bh==&amp;quot;&amp;quot;||row!==8)bh= &amp;quot;120&amp;quot;;
			if(bw==&amp;quot;&amp;quot;||row!==8)bw= &amp;quot;120&amp;quot;;

			var url = &amp;quot;show.sp?grdid=ImageEdit&amp;formguid=&amp;quot;+imgguid +&amp;quot;&amp;bigimgw=&amp;quot;+bw+&amp;quot;&amp;bigimgh=&amp;quot;+bh+&amp;quot;&amp;imgw=&amp;imgh=&amp;smlimgw=&amp;smlimgh=&amp;quot;;
			
			var ret = window.showModalDialog(url,&amp;quot;&amp;quot;,&amp;quot;dialogwidth:1024pt;dialogheight:600pt;help:yes;resizable:yes;&amp;quot;);
			if(ret!=undefined){
				
				var ss = ret.split(&amp;quot;,&amp;quot;);
				SetImageURL (sheet,row,col,prestr+ss[0]);
				if(ss.length&amp;gt;=5&amp;&amp;row==8){
					_this.SetCellText(sheet,row+1,2,ss[3]);
					_this.SetCellText(sheet,row+1,3,ss[4]);
				}
			}
		}catch(e){}
	}
	else if(id==&amp;quot;m_img_select&amp;quot;){//选择WEB图片
		var retval=window.showModalDialog(&amp;quot;iconbatch.sp?rettyp=WEBPATH&amp;quot;,&amp;quot;&amp;quot;,&amp;quot;dialogHeight=500pt; dialogWidth=800pt;status=no&amp;quot;); 
		if (retval!=&amp;quot;&amp;quot; &amp;&amp; retval!=undefined ){
			SetImageURL (sheet,row,col,retval );
		}
	}
	else if(id==&amp;quot;m_img_selectlib&amp;quot;){//选择图库
		var retval=window.showModalDialog(&amp;quot;LAYIMG.sp&amp;quot;,&amp;quot;&amp;quot;,&amp;quot;dialogHeight=500pt; dialogWidth=800pt;status=no&amp;quot;); 
		if (retval!=&amp;quot;&amp;quot; &amp;&amp; retval!=undefined ){
			SetImageURL (sheet,row,col,retval );	//skinguid=
		}
	}	
	
	else if(id==&amp;quot;m_img_preview&amp;quot;){//预览图片
		previewimg(GetImageURL (sheet,row,col));
	}
	else if(id==&amp;quot;m_img_upload&amp;quot;){//选择本地图片上传
		var filename = _this.SelectFile(&amp;quot;&amp;quot;);
 
		if (filename !=&amp;quot;&amp;quot; ) {
			_this.OpenHttpRequest(homeurl+&amp;quot;EAFormBlobUpload.sp&amp;quot;,&amp;quot;UPLOAD&amp;quot;);
			_this.AddHttpRequestParam(&amp;quot;action&amp;quot;,&amp;quot;upload&amp;quot;,0);
			_this.AddHttpRequestParam(&amp;quot;data&amp;quot;,filename ,1);
			_this.AddHttpRequestParam(&amp;quot;formguid&amp;quot;,&amp;quot;&amp;quot;,0);
			_this.AddHttpRequestParam(&amp;quot;sytid&amp;quot;,G_SYTID,0);
			_this.AddHttpRequestParam(&amp;quot;grdid&amp;quot;,G_GRDID,0);
			_this.AddHttpRequestParam(&amp;quot;fileurl&amp;quot;,filename ,0);
			
			var ret = _this.SendHttpRequest();
			_this.CloseHttpRequest();
 
			if(ret!=&amp;quot;&amp;quot; ) {
				alert(sheet+&amp;quot;|&amp;quot;+row+&amp;quot;|&amp;quot;+col+&amp;quot;|&amp;quot;+ret);
				SetImageURL (sheet,row,4,&amp;quot;EAFormBlob.sp?guid=&amp;quot;+ret);
			}
		}
	}
}
function SetImageURL (sheet,row,col,url ){
	if(sheet == sheet0 ){
		_this.SetCellText(sheet,row,col-1,url);
		_thisOnCellModify(sheet,row,col-1);
	 }

}

//修改单元格内容
function _thisOnCellModify(sheet,row,col,oldvalue,newvalue)
{
 


}

//test
function savetable()
{
	alert(invokeOSFunc(&amp;quot;savetable&amp;quot;,&amp;quot;abc=abcd&amp;usr=id&amp;quot;));
}


function openUrl(){
	
	if(_this.GetCellText(0,7,6)!=&amp;quot;&amp;quot;&amp;&amp;_this.GetCellText(0,7,3)!=&amp;quot;&amp;quot;){
		var func = _this.GetCellText(0,7,10);
		var url=&amp;quot;xlsgrid/jsp/design/designer.jsp?grdid=&amp;quot;+_this.GetCellText(0,7,6)+&amp;quot;&amp;sytid=&amp;quot;+_this.GetCellText(0,7,3)+&amp;quot;&amp;MWTYP=M&amp;opensheet=2&amp;addosfunc=&amp;quot;+func +&amp;quot;()&amp;sAddosfuncnote=Page Control show flag Script&amp;quot;;
		window.open(url);
	}
	else {
		alert ( &amp;quot;请输入所在中间件的参数&amp;quot; );
	}
	
}


//点击按钮
function _thisOnButtonCtrlClick(id,sheet,row,col)
{
	if(id==&amp;quot;编辑&amp;quot;){
		openUrl();
		
	}
}
function GetImageURL (sheet,row,col){
	return _this.GetCellText(sheet,row,col-4 );
}
function previewimg(url){
	window.open(url);
	//var w = window.open(&amp;quot;&amp;quot;,&amp;quot;&amp;quot;,&amp;quot;width:800;height:600&amp;quot;);
	//w.document.body.innerHTML=&amp;quot;&amp;lt;img src=&amp;apos;http://www.xlsgrid.net/xlsgrid/ROOT_XLSGRID/&amp;quot;+url+&amp;quot;&amp;apos;&amp;gt;&amp;quot;;
}
//保存单据数据前
function _thisOnbeforesave()
{
	// 保存文件到u/syt/sytxx/mwid.css u/syt/sytxx/mwid.js
	//POST方式调用网络OS函数
	var param = new Object();
	param.thisid = _this.GetCellText(0,5,3);
	param.thissytid = _this.GetCellText(0,7,3);
	param.css = _this.GetCellText(sheet1,-1,-1);
	param.js = _this.GetCellText(sheet2,-1,-1);
	
	if(param.css == &amp;quot;&amp;quot; ){
		
		_this.SetCellText(sheet0,9,10,&amp;quot;&amp;quot;);
	}
	else{
		 _this.SetCellText(sheet0,9,10,&amp;quot;syt&amp;quot;+param.thissytid+&amp;quot;/css/&amp;quot;+param.thisid+&amp;quot;.css&amp;quot;);
		 
	}
	if(param.js == &amp;quot;&amp;quot; )_this.SetCellText(sheet0,9,11,&amp;quot;&amp;quot;);
	else _this.SetCellText(sheet0,9,11,&amp;quot;syt&amp;quot;+param.thissytid+&amp;quot;/js/&amp;quot;+param.thisid+&amp;quot;.js&amp;quot;);
	
	try {
		msg = invokeOSFuncExt(&amp;quot;SaveCSSJS&amp;quot;,param);
		
	}
	catch (e) {
		alert ( e );
		return 1;
	}

	return 0;	 
}
</GRDJSDS_VALUE></ROW>
</ROWSET>
</grdjsds><grdosds>
<ROWSET>
<ROW num="0" ><GRDOSDS_VALUE >var pub  = new JavaPackage ( &amp;quot;com.xlsgrid.net.pub&amp;quot; );
var basePath = pub.EAOption.dynaDataRoot;
var pubpack= new JavaPackage(&amp;quot;com.xlsgrid.net.pub&amp;quot;);
var xmldb= new JavaPackage(&amp;quot;com.xlsgrid.net.xmldb&amp;quot;);
var xmldbpack = new JavaPackage ( &amp;quot;com.xlsgrid.net.xmldb&amp;quot; );
var iopack = new JavaPackage ( &amp;quot;java.io&amp;quot; );
var webpack = new JavaPackage ( &amp;quot;com.xlsgrid.net.web&amp;quot; );
var utilpack = new JavaPackage ( &amp;quot;java.util&amp;quot;);



function test(){
	var a = &amp;quot;&amp;quot;;
	var eas = new pub.EAScript(null);                		 
	//参数找到后，就执行方法，上面所指的funname其实是文件名字，MyFun是文件的根节点，funName是方法名字
	try{
		
		eas.DefineScopeVar(&amp;quot;request&amp;quot;, request);
		var a =  eas.CallClassFunc(&amp;quot;x_LHTMLEDIT&amp;quot;,&amp;quot;t&amp;quot;,null).castToString();
		return a;
	}catch(e){
		throw new Exception(e);
	}
 		
}

function t(){
	var a = request.getParameterNames();
		var ret = &amp;quot;&amp;quot;;
		var ret2 = &amp;quot;&amp;quot;;
		var i=0;
		while(a.hasMoreElements()&amp;&amp;i&amp;lt;10){
			var paramnam = a.nextElement().toString();
			ret +=paramnam+&amp;quot;|&amp;quot;;
			ret2 +=request.getParameter(paramnam)+&amp;quot;|&amp;quot;;
			i++;
		}
		 
		return ret+&amp;quot;\n哈哈成功\n&amp;quot;+ret2 ;
	return &amp;quot;进来了v&amp;quot;+abc;
}


function GetBody()
{
	var html = &amp;quot;&amp;quot;;
	
	var layhdrguid= request.getParameter( &amp;quot;layhdrguid&amp;quot; ) ;
	var sql = &amp;quot;select A.* from LSYSURL a,formblob b,formblob img where a.icon=img.guid(+) and a.htmlguid=b.guid and a.guid=&amp;apos;&amp;quot;+layhdrguid+&amp;quot;&amp;apos;&amp;quot;;
	var ds = db.QuerySQL(sql);
	var title = &amp;quot;&amp;quot;;
	var crtdat = &amp;quot;&amp;quot;;
	var image = &amp;quot;&amp;quot;;
	if(ds.getRowCount()&amp;gt;0){
		title = ds.getStringAt(0,&amp;quot;NAME&amp;quot;);
		crtdat = ds.getStringAt(0,&amp;quot;CRTDAT&amp;quot;);
		image = ds.getStringAt(0,&amp;quot;ICON&amp;quot;);
	}
	var context = db.getBlob2String(&amp;quot;select b.bdata from LSYSURL a,formblob b where a.htmlguid=b.guid and a.guid=&amp;apos;&amp;quot;+layhdrguid+&amp;quot;&amp;apos; for update&amp;quot;,&amp;quot;bdata&amp;quot;);
	html = &amp;quot;  
		&amp;lt;table   &amp;gt;
		&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;h1 style=\&amp;quot;   text-align: center; \&amp;quot;&amp;gt;&amp;quot;+title +&amp;quot;&amp;lt;/h1&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
		 &amp;lt;tr&amp;gt;&amp;lt;td align=center &amp;gt;&amp;quot;+crtdat+&amp;quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
		 &amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;hr style=\&amp;quot;border-bottom: 1px solid #DFDFDF; padding-left: 4px; padding-right: 4px; padding-top: 1px; padding-bottom: 1px\&amp;quot; size=\&amp;quot;0\&amp;quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
		 &amp;quot;;
	if(image!=&amp;quot;&amp;quot;){
		html +=&amp;quot;&amp;lt;tr&amp;gt;&amp;lt;td align=center &amp;gt;&amp;lt;img src=\&amp;quot;&amp;quot;+image +&amp;quot;\&amp;quot; border=\&amp;quot;0\&amp;quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;quot;;
	}
	
	html+= &amp;quot;
		 &amp;lt;tr&amp;gt;&amp;lt;td align=center &amp;gt;&amp;lt;table     width=90% style=\&amp;quot;text-align: left;\&amp;quot;  &amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;quot;+context +&amp;quot; &amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
		&amp;lt;/table&amp;gt;

		 &amp;quot;;
//	html = &amp;quot;&amp;lt;p align=\&amp;quot;center\&amp;quot;&amp;gt;&amp;lt;b&amp;gt;&amp;lt;font size=\&amp;quot;4\&amp;quot;&amp;gt;标题&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/p&amp;gt;
//		&amp;lt;hr style=\&amp;quot;border-bottom: 1px solid #DFDFDF; padding-left: 4px; padding-right: 4px; padding-top: 1px; padding-bottom: 1px\&amp;quot; size=\&amp;quot;0\&amp;quot;&amp;gt;
//		&amp;lt;p&amp;gt;&amp;lt;/p&amp;gt;
//		&amp;lt;p&amp;gt;&amp;lt;img src=\&amp;quot;\&amp;quot;&amp;gt;&amp;lt;/p&amp;gt;
//		&amp;lt;table border=\&amp;quot;0\&amp;quot; width=\&amp;quot;80%\&amp;quot; cellspacing=\&amp;quot;10\&amp;quot;&amp;gt;
//		 &amp;lt;tr&amp;gt;
//		  &amp;lt;td&amp;gt;&amp;quot;+context +&amp;quot;&amp;lt;/td&amp;gt;
//		 &amp;lt;/tr&amp;gt;
//		&amp;lt;/table&amp;gt;
//		&amp;lt;p&amp;gt;&amp;lt;/p&amp;gt;&amp;quot;;
//	html = &amp;quot;  &amp;lt;h1 style=\&amp;quot; height: auto;  text-align: center;margin-top: 10px;\&amp;quot;&amp;gt;&amp;quot;+title +&amp;quot;&amp;lt;/h1&amp;gt;
//		&amp;lt;div id=\&amp;quot;fbdate\&amp;quot; style=\&amp;quot;text-align: center;\&amp;quot;&amp;gt;2014&amp;lt;/div&amp;gt;
//		&amp;lt;div id=\&amp;quot;wenzi\&amp;quot; style=\&amp;quot;width: 630px; text-align: justify;margin: 0 auto;line-height: 23px;;BSHARE_POP blkContainerSblkCon clearfix blkContainerSblkCon_14;\&amp;quot;&amp;gt;
//		&amp;lt;div id=\&amp;quot;maincontent\&amp;quot;&amp;gt;&amp;lt;div id=\&amp;quot;ivs_content\&amp;quot;&amp;gt;&amp;quot;+context +&amp;quot;&amp;lt;/div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt; &amp;quot;;
//	html = &amp;quot;&amp;lt;h1 style=\&amp;quot; text-align: center;margin-top: 10px;\&amp;quot;&amp;gt;&amp;quot;+title +&amp;quot;&amp;lt;/h1&amp;gt;&amp;quot;;
	return  html;
}
//单据保存后
function fos_aftersave(eaContext)
//var eaContext=new pub.EAContext();
{
	var db = eaContext.getEADatabase();
	var ds = db.QuerySQL(&amp;quot;select * from LHTML &amp;quot;);
	var xml = ds.GetXml();
	pub.EAFunc.WriteToFile(basePath +&amp;quot;LHTML.xml&amp;quot;,xml);
	var ds = db.QuerySQL(&amp;quot;select * from LHTMLDTL &amp;quot;);
	var xml = ds.GetXml();
	pub.EAFunc.WriteToFile(basePath +&amp;quot;LHTMLDTL.xml&amp;quot;,xml);
}



// 保存
function SaveCSSJS()
{
	var udir = basePath +&amp;quot;syt/syt&amp;quot;+thissytid+&amp;quot;/&amp;quot;;
	var ufile = thisid;
	pubpack.EAFunc.WriteToFileEx(udir+&amp;quot;css/&amp;quot;+ufile+&amp;quot;.css&amp;quot;,css,false);
	pubpack.EAFunc.WriteToFileEx(udir+&amp;quot;js/&amp;quot;+ufile+&amp;quot;.js&amp;quot;,js,false);
		
	var srcpath = udir  ;//+ &amp;quot;/&amp;quot; +filename
	var destpath = pubpack.EAOption.approot+&amp;quot;/syt&amp;quot;+thissytid;//+ &amp;quot;/&amp;quot;+filename

	pubpack.EAFunc.copyDirectiory(udir,destpath,&amp;quot;&amp;quot;,&amp;quot;CVS&amp;quot;,true );
	return &amp;quot;服务端：文件已从&amp;quot;+ srcpath +&amp;quot;同步到&amp;quot;+destpath ;
}


// get css file text
function GetCSS()
{
	var udir = basePath +&amp;quot;syt/syt&amp;quot;+thissytid+&amp;quot;/&amp;quot;;
	var ufile = thisid;
	
	return pubpack.EAFunc.readFile(udir+&amp;quot;css/&amp;quot;+ufile+&amp;quot;.css&amp;quot;);
}

// get css file text
function GetJS()
{
	var udir = basePath +&amp;quot;syt/syt&amp;quot;+thissytid+&amp;quot;/&amp;quot;;
	var ufile = thisid;
	return pubpack.EAFunc.readFile(udir+&amp;quot;js/&amp;quot;+ufile+&amp;quot;.js&amp;quot;);
}

function savetable (){
		var web = new JavaPackage ( &amp;quot;com.xlsgrid.net.web&amp;quot; );
		var usr = web.EASession.GetLoginInfo(request);
		var homeurl = usr.getHomeURL();
		var orgid = usr.getOrgid();
		var accid = usr.getAccid();
		var usrid = usr.getUsrid();
		var usrnam = usr.getUsrnam();
		var db = null;
		var ds = &amp;quot;&amp;quot;;
		var ret =&amp;quot;&amp;quot;;
		var sql = &amp;quot;&amp;quot;;
		try{
			db = new pubpack.EADatabase();
			var table = &amp;quot;LHTML &amp;quot;;
			var ds = db.QuerySQL(&amp;quot;select * from &amp;quot;+table +&amp;quot; &amp;quot;);
			var xml = ds.GetXml();
			pub.EAFunc.WriteToFile(basePath +&amp;quot;&amp;quot;+table +&amp;quot;.xml&amp;quot;,xml);
			return &amp;quot;ok&amp;quot;;
		}catch(e){
			if(db!=null)db.Rollback();
			throw new Exception(e);
		}finally{
			if(db!=null) db.Close();
		}
		return &amp;quot;error&amp;quot;;
}

function implhtml(){
		var web = new JavaPackage ( &amp;quot;com.xlsgrid.net.web&amp;quot; );
		var usr = web.EASession.GetLoginInfo(request);
		var homeurl = usr.getHomeURL();
		var orgid = usr.getOrgid();
		var accid = usr.getAccid();
		var usrid = usr.getUsrid();
		var usrnam = usr.getUsrnam();
		var db = null;
		var ds = &amp;quot;&amp;quot;;
		var ret =&amp;quot;&amp;quot;;
		var sql = &amp;quot;&amp;quot;;
		try{
			db = new pubpack.EADatabase();
			var xml = pubpack.EAFunc.readFile(basePath +&amp;quot;LHTML.xml&amp;quot;);
			var ds = new pubpack.EAXmlDS( xml );//把xml读取成ds
			for(var i=0;i&amp;lt;ds.getRowCount();i++){
				var cols = &amp;quot;&amp;quot;;
				for (var c=1;c&amp;lt;ds.getColumnCount();c++){
					if(cols==&amp;quot;&amp;quot;){
						cols +=&amp;quot; &amp;apos;&amp;quot;+ds.getStringAt(i,c)+&amp;quot;&amp;apos; &amp;quot;;
					}else if(c==2||c==3){
						cols +=&amp;quot; ,sysdate &amp;quot;;
					}else{
						cols +=&amp;quot; ,&amp;apos;&amp;quot;+ds.getStringAt(i,c)+&amp;quot;&amp;apos; &amp;quot;;
					}
				}
				sql = &amp;quot;insert into lhtml select &amp;quot;+cols+&amp;quot; from dual&amp;quot;;
 
				db.ExcecutSQL(sql);
			}
			
			
			var xml = pubpack.EAFunc.readFile(basePath +&amp;quot;LHTMLDTL.xml&amp;quot;);
			var ds = new pubpack.EAXmlDS( xml );//把xml读取成ds
			for(var i=0;i&amp;lt;ds.getRowCount();i++){
				var cols = &amp;quot;&amp;quot;;
				for (var c=1;c&amp;lt;ds.getColumnCount();c++){
					if(cols==&amp;quot;&amp;quot;){
						cols +=&amp;quot; &amp;apos;&amp;quot;+ds.getStringAt(i,c)+&amp;quot;&amp;apos; &amp;quot;;
					}else{
						cols +=&amp;quot; ,&amp;apos;&amp;quot;+ds.getStringAt(i,c)+&amp;quot;&amp;apos; &amp;quot;;
					}
				}
				sql = &amp;quot;insert into lhtmlDTL select &amp;quot;+cols+&amp;quot; from dual&amp;quot;;
 
				db.ExcecutSQL(sql);
			}
			//throw new Exception(sql);
			ret = &amp;quot;OK&amp;quot;;
		}catch(e){
			if(db!=null)db.Rollback();
			throw new Exception(e);
		}finally{
			if(db!=null) db.Close();
		}
		return ret;
}



</GRDOSDS_VALUE></ROW>
</ROWSET>
</grdosds><grddscds>
<ROWSET>
<ROW num="0" ><ID >LHTML</ID><NAME ></NAME><DATDSC ></DATDSC><C4 >LHTML</C4></ROW>
</ROWSET>
</grddscds><fldhdr>
<ROWSET>
<ROW num="0" ><BILID >1单据编号</BILID><STAT >0单据状态</STAT><SUBTYP >0子类型</SUBTYP><CORPID >0往来单位编号</CORPID><CORPNAM >0往来单位名称</CORPNAM><LOCID >0仓库|部门编号</LOCID><LOCNAM >0仓库|部门名称</LOCNAM><DAT >0单据日期</DAT><CRTUSR >1录入人</CRTUSR><CRTUSRNAM >0录入人姓名</CRTUSRNAM><CRTDAT >0录入日期</CRTDAT><CHKUSR >1审核人</CHKUSR><CHKUSRNAM >0审核人姓名</CHKUSRNAM><CHKDAT >0审核日期</CHKDAT><SUMQTY >0合计金额</SUMQTY><SUMMNY >0合计金额</SUMMNY><REFID1 >0扩展字段</REFID1><REFNAM1 >0扩展字段</REFNAM1><REFID2 >0扩展字段</REFID2><REFNAM2 >0扩展字段</REFNAM2><REFID3 >0扩展字段</REFID3><REFNAM3 >0扩展字段</REFNAM3><REFID4 >0扩展字段</REFID4><REFNAM4 >0扩展字段</REFNAM4><REFID5 >0扩展字段</REFID5><REFNAM5 >0扩展字段</REFNAM5><REFID6 >0扩展字段</REFID6><REFNAM6 >0扩展字段</REFNAM6><NOTE >0备注</NOTE></ROW>
</ROWSET>
</fldhdr><flddtl>
<ROWSET>
<ROW num="0" ><SEQID >1明细序号</SEQID><ITMID >1品种编号</ITMID><ITMNAM >0品种名称</ITMNAM><ITEMPC >0品种批次号</ITEMPC><ITMSPC >0规格</ITMSPC><UNIT >0计量单位</UNIT><SMLUNT >0小计量单位</SMLUNT><UNTNUM >0大单位转小单位因子</UNTNUM><PRICE >0价格</PRICE><QTY >0数量</QTY><TAXTYP >0税率类型</TAXTYP><NOTAXMNY >0不含税税额</NOTAXMNY><TAXMNY >0税额</TAXMNY><MNY >0下单金额</MNY><REFID1 >0扩展字段</REFID1><REFNAM1 >0扩展字段</REFNAM1><REFID2 >0扩展字段</REFID2><REFNAM2 >0扩展字段</REFNAM2><REFID3 >0扩展字段</REFID3><REFNAM3 >0扩展字段</REFNAM3><REFID4 >0扩展字段</REFID4><REFNAM4 >0扩展字段</REFNAM4><REFID5 >0扩展字段</REFID5><REFNAM5 >0扩展字段</REFNAM5></ROW>
</ROWSET>
</flddtl></mdroot>